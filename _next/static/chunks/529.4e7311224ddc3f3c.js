"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[529],{84529:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var o=n(2784),a=n(5632),i=n(1136),s=n(85442),r=n(92122),c=n(41994);var d=e=>{window.lpTag=window.lpTag||{},"undefined"==typeof window.lpTag._tagCount?(window.lpTag={wl:lpTag.wl||null,scp:lpTag.scp||null,site:e||"88417709",section:lpTag.section||"",tagletSection:lpTag.tagletSection||null,autoStart:!1!==lpTag.autoStart,ovr:lpTag.ovr||{},_v:"1.10.0",_tagCount:1,protocol:"https:",events:{bind:function(e,t,n){lpTag.defer((function(){lpTag.events.bind(e,t,n)}),0)},trigger:function(e,t,n){lpTag.defer((function(){lpTag.events.trigger(e,t,n)}),1)}},defer:function(e,t){0===t?(this._defB=this._defB||[],this._defB.push(e)):1===t?(this._defT=this._defT||[],this._defT.push(e)):(this._defL=this._defL||[],this._defL.push(e))},load:function(e,t,n){var o=this;setTimeout((function(){o._load(e,t,n)}),0)},_load:function(e,t,n){var o=e;e||(o=this.protocol+"//"+(this.ovr&&this.ovr.domain?this.ovr.domain:"lptag.liveperson.net")+"/tag/tag.js?site="+this.site);var a=document.createElement("script");a.setAttribute("charset",t||"UTF-8"),n&&a.setAttribute("id",n),a.setAttribute("src",o),document.getElementsByTagName("head").item(0).appendChild(a)},init:function(){this._timing=this._timing||{},this._timing.start=(new Date).getTime();var e=this;window.attachEvent?window.attachEvent("onload",(function(){e._domReady("domReady")})):(window.addEventListener("DOMContentLoaded",(function(){e._domReady("contReady")}),!1),window.addEventListener("load",(function(){e._domReady("domReady")}),!1)),"undefined"===typeof window._lptStop&&this.load()},start:function(){this.autoStart=!0},_domReady:function(e){this.isDom||(this.isDom=!0,this.events.trigger("LPT","DOM_READY",{t:e})),this._timing[e]=(new Date).getTime()},vars:lpTag.vars||[],dbs:lpTag.dbs||[],ctn:lpTag.ctn||[],sdes:lpTag.sdes||[],hooks:lpTag.hooks||[],identities:lpTag.identities||[],ev:lpTag.ev||[]},lpTag.init()):window.lpTag._tagCount+=1},l=n(12803),u=n(21939),f=n(95503),p=n(89100);var g=({lpChatId:e,product:t})=>{const n=p.Z.get("LivePersonAuth"),i=(0,a.useRouter)(),{userCountryCode:s}=(0,o.useContext)(r.Il),c=(0,f.Z)(i).country;return(0,o.useEffect)((()=>{n.info("LivePersonAuth loaded"),d(e),window.lpTag.events.bind("lpUnifiedWindow","conversationInfo",(({conversationId:e})=>{e&&(localStorage.setItem(l.dA.LP_CONVERSATION_ID,e.toString()),localStorage.setItem(l.dA.CHAT_TIME,Date.now().toString()))})),window.lpTag.events.bind({eventName:"state",appName:"lpUnifiedWindow",func:window.lpMethods.livePersonChatStateEventHandler}),(0,u.of)(!0,c,t),(0,u.pm)(s)}),[e,t,s]),null};var h=({lpChatId:e,product:t})=>{const n=p.Z.get("LivePersonUnauth"),i=(0,a.useRouter)(),s=(0,f.Z)(i).country;return(0,o.useEffect)((()=>{d(e),window.lpTag.events.bind("lpUnifiedWindow","conversationInfo",(({conversationId:e})=>{e&&(localStorage.setItem(l.dA.LP_CONVERSATION_ID,e.toString()),localStorage.setItem(l.dA.CHAT_TIME,Date.now().toString()))})),window.lpTag.events.bind({eventName:"state",appName:"lpUnifiedWindow",func:window.lpMethods.livePersonChatStateEventHandler});const o=(0,u.M7)();(0,u.of)(o,s,t),n.info("LivePersonUnAuth loaded")}),[e,t]),null},v=n(95235),w=n(49177),m=n(42670),T=n(52322);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,v.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const _=(0,w.vU)({defaultLoadingMessage:{id:"Loading",defaultMessage:[{type:0,value:"Loading"}]},loadingChatSupport:{id:"Loading chat support...",defaultMessage:[{type:0,value:"Loading chat support..."}]}});function C({textKey:e}){const t=e?_[e]:_.defaultLoadingMessage;return(0,T.jsx)("div",{className:"loading-text-container",children:(0,T.jsx)(m.Z,b({},t))})}var E=n(74149),P=n(89225),S=n(25459);const I=p.Z.get("LivePersonAuthMain"),{getAuthCode:L}=(0,c.Z)({consumerIdentifier:"LivePerson"});var O=({lpChatId:e})=>{const{0:t,1:n}=(0,o.useState)(!1),{0:c,1:d}=(0,o.useState)(),p=(0,a.useRouter)(),{session:v,userId:w,crfToken:m,userCountryCode:y,loading:b,instrospectError:_,onLPMount:O,chatWithUsToggle:N,contactUsFormProduct:A}=(0,o.useContext)(r.Il),{0:M,1:j}=(0,o.useState)(!1),{openLpChat:k}=(0,P.y)(),{0:R,1:D}=(0,o.useState)(!0),U=(0,f.Z)(p).country,x=(0,o.useCallback)((e=>{var t,n;const o=!(v===l.R5.INITIAL_SESSION||v===l.R5.NO_SESSION),a=(0,u.QA)(y),i={section:(0,u.If)(o,U,A),sdes:a.hasOwnProperty("type")?[a]:[]};null!==(t=window)&&void 0!==t&&null!==(n=t.lpTag)&&void 0!==n&&n.newPage&&(I.info("Route changed, setting section and country code",i),window.lpTag.newPage(window.location.href,i)),u.Zo.closeLPWindow()}),[v,A,U,y]),Z=(0,o.useCallback)((async()=>{if(_||M){const e="lpGetAuthenticationToken while the app is in an error state";return Promise.reject(e)}if(!v||!w){const e="lpGetAuthenticationToken got called while logged out of helpcenter; relaying error to callback";return Promise.reject(e)}try{const e=await L(m);return I.info("Fetched auth code"),Promise.resolve(null===e||void 0===e?void 0:e.code)}catch(e){j(!0);const t=null===e||void 0===e?void 0:e.statusCode;if(t===S.HttpStatusCode.FORBIDDEN||t===S.HttpStatusCode.UNAUTHORIZED){const e="User attempted to fetch authcode while logged out, Refreshing page";return I.info(e),window.location.reload(),Promise.reject(e)}{const e="Failed to fetch authcode";return I.error(e),Promise.reject(e)}}}),[m,v,w,_,M]);(0,o.useEffect)((()=>{(0,E.q)({action:i.Us.view,componentType:i.re.button,eventName:"LP Chat Button",loggingId:"5fdae349-5275-4a84-8b08-6e32f5d02b49",category:"LP Chat",ga_action:"chat_button_view",label:"Message Us",url:"/".concat(p.locale).concat(p.asPath)})}),[]),(0,o.useEffect)((()=>{window.fetchAuthCode=Z}),[Z,_,M]),(0,o.useEffect)((()=>{void 0!==N&&(()=>{const e=document.getElementsByClassName("lp_minimized");if(null!==e&&void 0!==e&&e.length)return e[0].click();c&&c.click()})()}),[N]),(0,o.useEffect)((()=>{window.lpGetAuthenticationToken=e=>{(0,u.BO)(e,window.fetchAuthCode)},window.lpMethods={identityFn:u.RF,livePersonChatStateEventHandler:u.uV}}),[e]),(0,o.useEffect)((()=>{const e=v!==l.R5.INITIAL_SESSION&&v!==l.R5.NO_SESSION&&!!w;(0,u.nf)(e)}),[v,w]),(0,o.useEffect)((()=>{(0,u.Iv)(w),(0,u.mY)(y)}),[v,w,y]),(0,o.useEffect)((()=>{p.events.on("routeChangeComplete",x)}),[x,p.events,v]),(0,o.useMemo)((()=>{x(window.location.href)}),[A]),(0,o.useEffect)((()=>{""!==v&&n(!0)}),[v]);const[B,F]=(0,s.By)("cm_default_preferences");(0,o.useEffect)((()=>{const e=new MutationObserver((e=>{e.forEach((e=>{for(let t of e.addedNodes){const e=t;"LPMcontainer LPMoverlay"===e.className&&(k&&R&&(e.addEventListener("click",H),e.click(),D(!1)),d(e),O(!0))}}))}));return e.observe(document.body,{childList:!0}),()=>e.disconnect()}),[R,k]),(0,o.useEffect)((()=>{if(R){const e=new MutationObserver((e=>{e.forEach((e=>{for(let t of e.addedNodes){const e=t;"LPMcontainer LPMoverlay"===e.className&&e.addEventListener("click",H)}}))}));return e.observe(document.body,{childList:!0}),()=>e.disconnect()}}),[R]),(0,o.useEffect)((()=>{c&&c.setAttribute("data-cookie-consent","".concat(!!B))}),[B,c]);const H=()=>{(0,E.q)({action:i.Us.click,componentType:i.re.button,eventName:"LP Chat Message Us Button",loggingId:"89d59d55-0c43-49c5-9fc2-10f4bd9301cb",category:"LP Chat",ga_action:"chat_initiated",label:"Message Us",url:"/".concat(p.locale).concat(p.asPath)})},W=(0,o.useCallback)((()=>k&&R?(0,T.jsx)(C,{textKey:"loadingChatSupport"}):null),[R,k]);return!t||b?W():_||M?(0,T.jsx)(h,{lpChatId:e}):(0,T.jsxs)(T.Fragment,{children:[W(),v&&w?(0,T.jsx)(g,{lpChatId:e,product:A}):(0,T.jsx)(h,{lpChatId:e,product:A})]})}}}]);
//# sourceMappingURL=529.4e7311224ddc3f3c.js.map