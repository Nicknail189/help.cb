"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{50117:function(e,n,t){t.d(n,{$1:function(){return N},$D:function(){return O},BX:function(){return D},CV:function(){return F},E_:function(){return h},FI:function(){return C},FZ:function(){return E},Io:function(){return A},L8:function(){return k},MZ:function(){return V},Mm:function(){return L},Qj:function(){return R},ZD:function(){return I},b7:function(){return K},bv:function(){return M},ej:function(){return B},iq:function(){return S},uX:function(){return j}});var a=t(1136),r=t(65612),i=t(2784);t(92259),t(82899);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function l(){l=function(e,n){return new t(e,void 0,n)};var e=RegExp.prototype,n=new WeakMap;function t(e,a,r){var i=new RegExp(e,a);return n.set(i,r||n.get(e)),u(i,t.prototype)}function a(e,t){var a=n.get(t);return Object.keys(a).reduce((function(n,t){var r=a[t];if("number"==typeof r)n[t]=e[r];else{for(var i=0;void 0===e[r[i]]&&i+1<r.length;)i++;n[t]=e[r[i]]}return n}),Object.create(null))}return s(t,RegExp),t.prototype.exec=function(n){var t=e.exec.call(this,n);if(t){t.groups=a(t,this);var r=t.indices;r&&(r.groups=a(r,this))}return t},t.prototype[Symbol.replace]=function(t,r){if("string"==typeof r){var i=n.get(this);return e[Symbol.replace].call(this,t,r.replace(/\$<([^>]+)>/g,(function(e,n){var t=i[n];return"$"+(Array.isArray(t)?t.join("$"):t)})))}if("function"==typeof r){var l=this;return e[Symbol.replace].call(this,t,(function(){var e=arguments;return"object"!=o(e[e.length-1])&&(e=[].slice.call(e)).push(a(e,l)),r.apply(this,e)}))}return e[Symbol.replace].call(this,t,r)},l.apply(this,arguments)}function s(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&u(e,n)}function u(e,n){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},u(e,n)}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function d(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){p(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==o(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===o(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function g(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,o,l=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=i.call(t)).done)&&(l.push(a.value),l.length!==n);s=!0);}catch(c){u=!0,r=c}finally{try{if(!s&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return l}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var v={short:3e5},m="X-CB-Platform",y="X-CB-Chat-Agent";function b(e){return async function(n,t){return e(n,d(d({},t),{},{reactNative:{textStreaming:!0}}))}}function h(e){var n,t=e.graphqlUrl,i=e.sdkMeta,o=i.version,l=i.isApp,s=e.setHeaders,u=e.fetcher,c=e.getPersistedQueries,f=null!==u&&void 0!==u?u:(0,r.Fc)(r.QD),h=[];l&&h.push(b);return h.push((function(e){return async function(t,r){var i,u;return void 0===n&&(u=null===r||void 0===r?void 0:r.headers,n=!!u&&(u instanceof Headers?!!u.get(m):Array.isArray(u)?!!u.find((function(e){return g(e,1)[0]===m})):!!u[m])),e(t,d(d({},r),{},{headers:d(d(d({},n?{}:(0,a.zy)()),null===r||void 0===r?void 0:r.headers),{},p({},y,"".concat(l?"app":"web","/").concat(o)),null!==(i=null===s||void 0===s?void 0:s(t))&&void 0!==i?i:{})}))}})),(0,r.sI)({graphqlUrl:t,defaultTtl:v.short,networkFetch:(0,r.Mz)(h,f),getPersistedQueries:c})}function C(e){return(0,i.useEffect)(e,[])}function k(e){return(0,i.useEffect)((function(){return e}),[])}function x(e){var n=e.payload,t=e.onError,a=e.defaultValue;if(!n)return a;try{return JSON.parse(n)}catch(r){return null===t||void 0===t||t(r,r instanceof SyntaxError?[{type:"INVALID_JSON"}]:[]),a}}function S(e){var n=e.items,t=e.getStorageActiveKey,a=e.setStorageActiveKey,r=e.storageKey,o=g((0,i.useState)(),2),l=o[0],s=o[1],u=function(){var e=(0,i.useRef)(!1);return(0,i.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),(0,i.useCallback)((function(){return e.current}),[])}(),c=(0,i.useCallback)((function(e){s(e),a(r,e)}),[r,a]);return(0,i.useEffect)((function(){n.length&&t(r).then((function(e){u()&&s(null!==e&&void 0!==e?e:"")})).catch((function(){s("")}))}),[t,u,r,n.length]),{activeKey:l,onItemPress:c}}function j(e){var n=e.payload,t=e.onError,a=[],r=[];if(!n)return a;var i=x({payload:n,onError:t,defaultValue:{}}),o=Object.keys(i);return o.length?(o.forEach((function(e,n){a.push({title:e,content:i[e],key:"key_".concat(n)})})),r.length&&(null===t||void 0===t||t(void 0,r)),a):a}function E(e){return x({payload:e.payload,onError:e.onError,defaultValue:{title:null,message:null}})}var T={DEFAULT_BOT_NAME:"defaultBotName"};function O(e){if(!e)return null;var n=null===e||void 0===e?void 0:e.reduce((function(e,n){return null!==n&&void 0!==n&&n.key&&null!==n&&void 0!==n&&n.value&&T[n.key]?(e[T[n.key]]=n.value,e):e}),{});return n||null}var w={cb_chat_starting_latency:"8476a397-3c41-4afe-a3a7-b1d46127a4f1",cb_chat_message_latency:"9f1c833f-12ac-482c-848c-f44f808dc264",cb_chat_message_overall_latency:"391c8d57-6d32-45a2-8d4c-ef74560b1f34",cb_chat_start_latency_loader:"32d0ece5-ab4d-41f7-83af-d66c8631345f"},_={cb_chat_starting_latency:"cb.chat_support.latency.first_message",cb_chat_message_overall_latency:"cb.chat_support.latency.subsequent_message"},U={},P={};function I(e,n,t,a){U[e]=d(d({},a),{},{startTime:Date.now(),source:n,type:t})}function F(e){delete U[e]}function M(e){return U[e]}function D(){U={}}function K(e,n,t){var r=U[e];if(r&&!(r.startTime<=0)){var i=Date.now()-r.startTime;(0,a.Kz)(e,d(d(d({},t),P),{},{action:a.Us.render,componentType:a.re.page,loggingId:w[e],conversation_id:n,latency:i,source:r.source},"undefined"!==typeof r.type?{type:r.type}:{})),delete U[e];var o=_[e];o&&(0,a.HR)({metricName:o,metricType:a.t0.histogram,value:i,tags:t})}}function L(e){var n=e.message,t=e.regexes,a=e.replaceChar,r=void 0===a?"*":a,i=e.onError;return t.length?t.filter((function(e){return function(e){try{return new RegExp(e.replaceAll(/^\//gi,"").replaceAll(/\/[gim]{0,3}$/gim,""),"gmi"),!0}catch(n){return!1}}(e.regex)})).map((function(e){return{label:e.label,regex:new RegExp(e.regex.replaceAll(/^\//gi,"").replaceAll(/\/[gim]{0,3}$/gim,""),"gmi")}})).reduce((function(e,n){var t=n.regex;try{var a=Array.from(e.matchAll(t)),o="",l=0;return a.length?(a.forEach((function(n){if("number"===typeof n.index)if(""!==n[0]){var t=/[\w\d]/gim,a=n.groups?Object.keys(n.groups).filter((function(e){var t,a;return Boolean(null===(t=n.groups)||void 0===t||null===(a=t[e])||void 0===a?void 0:a.trim())})).map((function(e){var t,a;return null!==(t=null===(a=n.groups)||void 0===a?void 0:a[e])&&void 0!==t?t:""})):[];a.length?(o=a.reduce((function(e,a){var i=a.replaceAll(t,r);return e.substring(0,n.index)+e.substring(n.index).replace(a,i)}),o||e),l=e.length):(o+=e.substring(l,n.index),o+=n[0].replaceAll(t,r),l=n.index+n[0].length)}else l=n.index})),l<e.length&&(o+=e.substring(l)),o):e}catch(s){return null===i||void 0===i||i(s),e}}),n):n}function B(e){return!!e&&e.endsWith("BOT")}function A(e){return!!e&&"USER"===e}function N(e){return!!e&&e.endsWith("AGENT")}function R(e){return!!e&&("SYSTEM"===e||e.endsWith("CONTROLLER"))}function V(e){if(!e)return[];var n=l(/(?:<a href="?([^"\s]*?)"?>(.*?)<\/a>)|(#md#\[(.*?)\]\((.*?)\)#\/md#)/gim,{hrefLink:1,hrefText:2,mdText:4,mdLink:5});try{var t=e.matchAll(n),a=Array.from(t);if(!a.length)return[{text:e}];var r=[],i=0;return a.forEach((function(n){var t,a,o,l,s,u,c;if("number"===typeof n.index){r.push({text:e.substring(i,n.index)});var d=null!==(t=null!==(a=null===(o=n.groups)||void 0===o?void 0:o.hrefText)&&void 0!==a?a:null===(l=n.groups)||void 0===l?void 0:l.mdText)&&void 0!==t?t:"",p=null!==(s=null===(u=n.groups)||void 0===u?void 0:u.hrefLink)&&void 0!==s?s:null===(c=n.groups)||void 0===c?void 0:c.mdLink;r.push({text:d,link:p}),i=n.index+n[0].length}})),i<e.length&&r.push({text:e.substring(i)}),r}catch(o){return[{text:e}]}}},21948:function(e,n,t){t.d(n,{A:function(){return ve},B:function(){return kt},C:function(){return tn},D:function(){return Ae},E:function(){return He},F:function(){return Ne},G:function(){return mn},H:function(){return on},I:function(){return Be},J:function(){return Mn},M:function(){return gt},P:function(){return yn},W:function(){return De},a:function(){return ze},b:function(){return ke},c:function(){return Qe},d:function(){return ln},e:function(){return Ce},f:function(){return Le},g:function(){return We},h:function(){return jn},i:function(){return Cn},j:function(){return ye},k:function(){return St},l:function(){return Et},m:function(){return Tt},n:function(){return jt},o:function(){return gn},p:function(){return Ye},q:function(){return hn},r:function(){return Ge},s:function(){return $e},t:function(){return wt},u:function(){return rn},v:function(){return Ot},w:function(){return sn},x:function(){return fe},y:function(){return xe},z:function(){return Pe}});var a=t(2784),r=t(50117),i=t(59508),o=t(88410),l=t(1136),s=t(52322),u=t(62346),c=t(76470),d=t(18411),p=t(95791),g=t(33389),f=t(86421),v=t(65060),m=t(49177),y=t(83112),b=t(29904),h=t(43013),C=t(94087),k=t(23849),x=t(32111),S=t(18983),j=t(46364),E=t(39634),T=t(65612),O=t(14823),w=t(11536),_=t(63952),U=t(52944),P=t(48972),I=t(61641),F=t(92259),M=t(82899),D=t(24728),K=t(66332),L=t(46316),B=t(55873),A=t(53127),N=t(68130),R=t(68939),V=t(40380),H=t(98412),W=t(31744),z=t(53859),$=t(61715),G=t(28116),q=t(36886),Q=t(3781),Z=t(55017),J=t(63296);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}var X=["children"],ee=["lastReceivedMessageParticipantType","unreadMessageCount","loading","disabled"],ne=["messagePromptText"],te=["children","isConversationClosed","layout"],ae=["children","graphqlUrl","getPersistedQueries","isDisabled"],re=["children"],ie=["children"],oe=["children"];function le(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function se(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?le(Object(t),!0).forEach((function(n){ue(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):le(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function ue(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==Y(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==Y(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===Y(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ce(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function de(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,o,l=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=i.call(t)).done)&&(l.push(a.value),l.length!==n);s=!0);}catch(c){u=!0,r=c}finally{try{if(!s&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return l}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return pe(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return pe(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var ge=(0,a.createContext)({isChatOpen:!1,toggleChatOpen:function(){}});function fe(){return(0,a.useContext)(ge)}function ve(e){var n=e.children,t=e.isInitiallyOpen,r=void 0!==t&&t,i=de((0,a.useState)(r),2),o=i[0],l=i[1],u=(0,a.useCallback)((function(){return l((function(e){return!e}))}),[]),c=(0,a.useMemo)((function(){return{isChatOpen:o,toggleChatOpen:u}}),[o,u]);return(0,s.jsx)(ge.Provider,{value:c,children:n})}var me=(0,a.createContext)({});function ye(){return(0,a.useContext)(me)}function be(e){var n=e.children,t=ce(e,X);return(0,s.jsx)(me.Provider,{value:t,children:n})}var he={cbchat_header_meatball_menu:"07a895c5-eca3-4531-850e-27cd6a4b2d9e",cbchat_tray_end_conversation_cancel:"4ac6f0c3-c951-4f40-ba82-6d4374c1e08e",cbchat_conversation_close_back_support:"d303a39a-94db-436c-86d1-ffff66fb27a9",cbchat_conversation_close_start_conversation:"ecf5cf9a-8940-4e1e-8deb-b660aeacded9",cbchat_canned_response_type_my_response:"cc524449-3789-4733-8304-043690ffc608",cbchat_scroll_to_bottom:"05ea5068-b6cf-40c7-8103-683318c66113",cbchat_send_message_retry:"ac4ea501-6d63-4fe2-8c49-32d2f7216f49",cbchat_tray_end_conversation_soft:"59c6a564-a1b8-4923-9e51-df321c808fba",cbchat_tray_end_conversation_force:"bb3db8a0-23c9-434c-b39e-3cbf1c34e0aa",back_to_support_home_button_click:"4db64f4e-c2ae-4f7c-a495-33384c71b1b4",cb_chat_system_status:"fdf7e846-6154-4492-8a9b-8de53866c052",cb_chat_create_conversation:"a03723d4-3d66-4ddc-869d-f93cc7910b8b",cb_chat_send_message:"fdf7e846-6154-4492-8a9b-8de53866c052",cb_chat_collapse_icon:"3afa156e-c0c6-462f-b6fa-f017dc78ce92",cb_chat_x_button:"ff802abd-c4ac-4557-b621-fe2cf4f80b64",cb_chat_entry_press:"656838e1-4d81-485c-bb81-f9eca2072a33",cb_chat_entry_impression:"e0951378-dbd0-4e1e-a495-3694bd416681"};function Ce(e,n,t){n&&(0,l.Kz)(e,se(se({},t),{},{componentType:l.re.button,loggingId:he[e],conversation_id:n,action:l.Us.click}))}function ke(e,n,t){(0,l.Kz)(e,se({componentType:l.re.unknown,loggingId:he[e],conversation_id:n,action:l.Us.unknown},t))}function xe(e,n){(0,l.Kz)(e,se(se({action:l.Us.unknown,componentType:l.re.unknown},n),{},{loggingId:he[e]}))}function Se(e){var n=e.lastReceivedMessageParticipantType,t=void 0===n?"":n,a=e.loading,i=(0,g.useLogoMark)({size:32}),o=i.viewBox,l=i.path,u=i.height,c=i.width;return a?(0,s.jsx)(v.$,{size:3,color:"primary",testID:"chat-entry-button-spinner"}):(0,r.ej)(t)?(0,s.jsx)("svg",{viewBox:o,width:c,height:u,"data-testid":"bot-icon",children:(0,s.jsx)("path",{d:l,fill:"white"})}):(0,r.$1)(t)?(0,s.jsx)(f.Icon,{name:"chatBotAgent",size:"m",color:"primaryForeground",testID:"agent-icon"}):(0,s.jsx)(f.Icon,{name:"chatBubble",size:"m",color:"primaryForeground",testID:"bubble-icon"})}function je(e){var n=e.lastReceivedMessageParticipantType,t=void 0===n?"":n,a=e.unreadMessageCount,r=void 0===a?0:a,o=e.loading,l=e.disabled,u=ce(e,ee);return(0,s.jsx)(p.Pressable,se(se({as:"button",backgroundColor:"primary",borderRadius:"round",borderWidth:"none",height:"fit-content",width:"fit-content",elevation:2,loading:o,disabled:l},u),{},{children:(0,s.jsx)(d.DotCount,{pin:"top-end",count:r,children:(0,s.jsx)(i.Box,{height:56,width:56,justifyContent:"center",alignItems:"center",children:(0,s.jsx)(Se,{lastReceivedMessageParticipantType:t,loading:o})})})}))}var Ee=(0,m.vU)({chatEntryDisabledTitle:{id:"ChatEntry.chatEntryDisabledTitle",defaultMessage:"Chat is temporarily down",description:"Title of tooltip content shown when chat entry button is disabled"},chatEntryDisabledSubtitle:{id:"ChatEntry.chatEntryDisabledSubtitle",defaultMessage:"We'll solve the problem soon",description:"Subtitle of tooltip content shown when chat entry button is disabled"}});function Te(){var e=(0,y.Z)().formatMessage;return(0,s.jsxs)(b.VStack,{gap:.5,spacing:1,children:[(0,s.jsx)(h.TextHeadline,{as:"label",children:e(Ee.chatEntryDisabledTitle)}),(0,s.jsx)(C.TextLabel2,{as:"label",color:"foregroundMuted",children:e(Ee.chatEntryDisabledSubtitle)})]})}function Oe(e){var n=e.text,t=(0,a.useMemo)((function(){return n.split("\n")}),[n]);return(0,s.jsx)(s.Fragment,{children:t.map((function(e,n){return n>=t.length-1?e:(0,s.jsxs)(a.Fragment,{children:[e,(0,s.jsx)("br",{})]},n)}))})}function we(e){var n=e.text,t=e.linkColor,i=e.renderTokens,o=void 0===i||i,l=(0,a.useMemo)((function(){return o?(0,r.MZ)(n):n?[{text:n}]:[]}),[o,n]);return l.length?(0,s.jsx)(s.Fragment,{children:l.map((function(e){return(0,s.jsx)(a.Fragment,{children:e.link?(0,s.jsx)(L.Link,{href:e.link,underline:!0,openInNewWindow:!0,color:t,children:(0,s.jsx)(Oe,{text:e.text})}):(0,s.jsx)(Oe,{text:e.text})},e.text)}))}):null}var _e={borderBottomRightRadius:0};function Ue(e){var n=e.messageText;return(0,s.jsx)(i.Box,{spacing:2,background:"background",elevation:2,borderRadius:"standard",bordered:!1,maxWidth:224,maxHeight:128,overflow:"hidden",dangerouslySetStyle:_e,children:(0,s.jsx)(k.TextBody,{as:"p",numberOfLines:4,overflow:"wrap",children:(0,s.jsx)(we,{text:n})})})}function Pe(e){var n=e.messagePromptText,t=ce(e,ne);return t.disabled?(0,s.jsx)(c.u,{content:(0,s.jsx)(Te,{}),placement:"top",children:(0,s.jsx)(je,se({},t))}):n?(0,s.jsxs)(u.HStack,{gap:1,alignItems:"flex-end",children:[(0,s.jsx)(Ue,{messageText:n}),(0,s.jsx)(je,se({},t))]}):(0,s.jsx)(je,se({},t))}var Ie={width:"100%",height:600,minWidth:376,maxWidth:376},Fe={position:"fixed",bottom:0,right:0,top:0,left:0,maxWidth:"100vw",maxHeight:"100vh",zIndex:3,overscrollBehavior:"contain",boxSizing:"border-box"};function Me(e,n){var t="mobile"===n?Fe:Ie;return se(se({},t),{},e?{paddingBottom:176}:{paddingBottom:0})}var De=(0,a.memo)((function(e){var n=e.children,t=e.isConversationClosed,a=e.layout,r=ce(e,te);return(0,s.jsx)(P.VStack,se(se({testID:"widget-layout",background:"background",borderRadius:"mobile"===a?"roundedNone":"roundedLarge",elevation:2,overflow:"hidden",dangerouslySetStyle:Me(t,a)},r),{},{children:n}))})),Ke={height:"40px",width:"40px"};function Le(){return(0,s.jsxs)(b.VStack,{spacingHorizontal:2,gap:1,spacingVertical:2,spacingBottom:10,flexGrow:1,children:[(0,s.jsx)(i.Box,{justifyContent:"center",alignItems:"center",width:"100%",children:(0,s.jsx)(E.Fallback,{height:20,width:80,testID:"fallback"})}),(0,s.jsxs)(u.HStack,{gap:1,children:[(0,s.jsx)(i.Box,{alignSelf:"flex-end",children:(0,s.jsx)(E.Fallback,{height:32,width:32,shape:"circle",testID:"fallback-circle"})}),(0,s.jsx)(i.Box,{flexGrow:1,children:(0,s.jsx)(E.Fallback,{shape:"squircle",height:80,width:"100%",testID:"fallback-squircle"})})]})]})}function Be(e){var n=e.onCollapse,t=e.layout;return(0,s.jsxs)(De,{layout:t,isConversationClosed:!1,children:[(0,s.jsxs)(u.HStack,{spacingHorizontal:2,spacingVertical:"mobile"===t?1:3,justifyContent:"space-between",alignItems:"center",width:"100%",children:["mobile"===t&&(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsx)(x.IconButton,{name:"close",variant:"secondary",transparent:!0,onClick:n,testID:"close-button"})}),(0,s.jsxs)(u.HStack,{gap:1,alignItems:"center",children:["mobile"!==t&&(0,s.jsx)(S.Pictogram,{dimension:"48x48",name:"supportChat",scaleMultiplier:.5,testID:"support-chat-pictogram"}),(0,s.jsx)(E.Fallback,{height:20,width:120})]}),"mobile"!==t?(0,s.jsx)(x.IconButton,{name:"caretDown",variant:"secondary",testID:"caret-down-icon",transparent:!0,onClick:n}):(0,s.jsx)(i.Box,{dangerouslySetStyle:Ke})]}),(0,s.jsx)(j.Divider,{}),(0,s.jsx)(Le,{})]})}function Ae(){var e=ye().visible,n=void 0===e||e,t=fe(),r=t.isChatOpen,i=t.toggleChatOpen,o=(0,a.useCallback)((function(){i(),ke("cb_chat_collapse_icon",null,{status:r?"open":"close",action:l.Us.click,componentType:l.re.button})}),[r,i]);return r?(0,s.jsx)(Be,{onCollapse:o}):n?(0,s.jsx)(Pe,{loading:!0}):null}function Ne(){return(0,s.jsx)(c.u,{content:(0,s.jsx)(Te,{}),placement:"top",testID:"tooltip-component",children:(0,s.jsx)(je,{disabled:!0,testID:"chat-entry-button"})})}var Re,Ve="1.10.0",He={context:"cb_chat",isHandled:!1,severity:"critical",isUserVisible:!0,CB_CHAT_WEB_SDK_PACKAGE_VERSION:Ve};function We(){return Re||(Re=(0,o.S1)({apiKey:"7d3479783228328ac91244cddd383747",environment:"production",appVersion:Ve,useGlobalHandlers:!1}))}function ze(e,n){try{var t,a=null!==(t=window.localStorage.getItem(e))&&void 0!==t?t:"";return"undefined"!==typeof a&&"undefined"!==a&&""!==a?JSON.parse(a):n}catch(r){return r instanceof Error&&We().logError(r,{context:"local_storage_utils",severity:"error",isHandled:!0,key:e}),n}}function $e(e,n){try{window.localStorage.setItem(e,JSON.stringify(n))}catch(t){t instanceof Error&&We().logError(t,{context:"local_storage_utils",severity:"error",isHandled:!0,key:e})}}function Ge(e){try{window.localStorage.removeItem(e)}catch(n){n instanceof Error&&We().logError(n,{context:"local_storage_utils",severity:"error",isHandled:!0,key:e})}}var qe=(0,a.createContext)({updateLatestEvent:function(){}});function Qe(){return(0,a.useContext)(qe)}function Ze(e){var n=e.children,t=de((0,a.useState)(ze("LOCAL_STORAGE_LATEST_EVENT_KEY",void 0)),2),r=t[0],i=t[1],o=(0,a.useCallback)((function(e){i((function(n){return null!==n&&void 0!==n&&n.createTime?new Date(e.createTime)>=new Date(n.createTime)?e:n:e}))}),[]),l=(0,a.useMemo)((function(){return{latestEvent:r,updateLatestEvent:o}}),[r,o]);return(0,a.useEffect)((function(){r&&$e("LOCAL_STORAGE_LATEST_EVENT_KEY",r)}),[r]),(0,s.jsx)(qe.Provider,{value:l,children:n})}var Je=(0,a.createContext)({queryFetchKey:0,triggerQueryRefetch:function(){}});function Ye(){return(0,a.useContext)(Je)}function Xe(e){var n=e.children,t=de((0,a.useState)(0),2),r=t[0],i=t[1],o=(0,a.useCallback)((function(){return i((function(e){return Math.min(e+1,10)}))}),[]),l=(0,a.useMemo)((function(){return{queryFetchKey:r,triggerQueryRefetch:o}}),[r,o]);return(0,s.jsx)(Je.Provider,{value:l,children:n})}var en=(0,a.memo)((function(e){var n=e.graphqlUrl,t=void 0===n?"/graphql/query":n,i=e.getPersistedQueries,o=e.fetcher,l=e.children,u=(0,a.useMemo)((function(){return(0,r.E_)({graphqlUrl:t,sdkMeta:{version:Ve,isApp:!1},fetcher:o,getPersistedQueries:i})}),[]);return(0,s.jsx)(T.c4,{environment:u,children:l})})),nn={client:We()},tn=(0,a.memo)((function(e){var n=e.children,t=e.graphqlUrl,l=e.getPersistedQueries,u=e.isDisabled,c=ce(e,ae),d=c.createConversationParams,p=c.mode,g=c.visible,f=c.layout,v=c.enableDebugMode,m=c.fetcher;(0,r.FI)((function(){(0,r.BX)()})),(0,a.useEffect)((function(){xe("cb_chat_system_status",u?{status:"down"}:{status:"up"})}),[u]);var y=(0,a.useMemo)((function(){return se(se({},He),{},{createConversationParams:JSON.stringify(d),mode:p,isDisabled:u,visible:g,layout:f,enableDebugMode:v})}),[d,v,u,f,p,g]);return(0,s.jsx)(o.Pe,{value:nn,children:(0,s.jsx)(o.SV,{fallback:(0,s.jsx)(Ne,{}),name:"cb-chat",defaultMetadata:y,children:(0,s.jsx)(en,{graphqlUrl:t,getPersistedQueries:l,fetcher:m,children:(0,s.jsx)(be,se(se({isDisabled:u},c),{},{children:(0,s.jsx)(ve,{children:(0,s.jsx)(Ze,{children:(0,s.jsx)(Xe,{children:(0,s.jsx)(i.Box,{position:"relative",children:(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)(Ae,{}),children:n})})})})})}))})})})})),an=(0,a.createContext)({conversationUuid:"",guestUserUuid:""});function rn(){return(0,a.useContext)(an)}function on(e){var n=e.children,t=ce(e,re);return(0,s.jsx)(an.Provider,{value:t,children:n})}function ln(e){if(e&&!(e.length<=0))return e[e.length-1]}function sn(e){return e?"https://help.coinbase.com/".concat(e):"https://help.coinbase.com"}var un=(0,m.vU)({defaultBotTitle:{id:"ChatSupport.ChatHeader.defaultBotTitle",defaultMessage:"Coinbase Assistant",description:"Default bot name to show in header"},endChat:{id:"ChatSupport.ChatHeader.endChat",defaultMessage:"End chat",description:"Action to close a conversation."},isTyping:{id:"ChatSupport.ChatHeader.isTyping",defaultMessage:"is typing...",description:"showing is typing indicator"}});function cn(e){var n=e.isDisabled,t=e.onCloseConversation,a=(0,y.Z)().formatMessage;return(0,s.jsx)(p.Pressable,{testID:"end-chat-button",as:"button",backgroundColor:"transparent",block:!0,disabled:n,onPress:t,children:(0,s.jsx)(i.Box,{spacingHorizontal:2,spacingVertical:1,children:(0,s.jsx)(k.TextBody,{as:"span",spacingVertical:.5,color:"negative",children:a(un.endChat)})})})}var dn={placement:"bottom-end",gap:2},pn={height:"40px",width:"40px"},gn=(0,a.memo)((function(e){var n,t,r=e.agentParticipant,o=e.isAgentActive,l=e.config,c=e.conversationUuid,d=e.isConversationClosed,p=void 0!==d&&d,g=e.isTyping,f=e.isClosingConversation,v=e.onCloseConversation,m=(0,y.Z)().formatMessage,b=(0,a.useRef)(null),C=rn().onCollapse,k=ye(),j=k.onClose,E=k.mode,T=void 0===E?"LOGGED_IN":E,O=k.layout,w=(0,a.useCallback)((function(){null===C||void 0===C||C(),null===j||void 0===j||j(),Ce("cb_chat_x_button",c,{unauth:"LOGGED_OUT"===T})}),[C,c,T,j]),_=(0,a.useCallback)((function(){Ce("cbchat_header_meatball_menu",c,{unauth:"LOGGED_OUT"===T})}),[c,T]),F=(0,a.useCallback)((function(){var e;null===(e=b.current)||void 0===e||e.closeMenu(),null===v||void 0===v||v()}),[v]);return"mobile"===O?(0,s.jsx)(i.Box,{spacingVertical:.5,spacingHorizontal:2,children:(0,s.jsxs)(u.HStack,{spacingVertical:.5,justifyContent:"space-between",alignItems:"center",width:"100%",children:[(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsx)(x.IconButton,{name:"close",variant:"secondary",transparent:!0,onClick:w,testID:"close-button"})}),(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsxs)(P.VStack,{justifyContent:"center",alignItems:"center",height:44,maxHeight:44,children:[(0,s.jsx)(h.TextHeadline,{as:"h3",children:o&&r?r.displayName:null!==(t=null===l||void 0===l?void 0:l.defaultBotName)&&void 0!==t?t:m(un.defaultBotTitle)}),g&&!p&&(0,s.jsx)(I.TextLabel2,{as:"p",color:"foregroundMuted",children:m(un.isTyping)})]})}),(0,s.jsx)(i.Box,{alignItems:"center",children:p?(0,s.jsx)(i.Box,{dangerouslySetStyle:pn}):(0,s.jsx)(U.Dropdown,{ref:b,content:(0,s.jsx)(cn,{isDisabled:f,onCloseConversation:F}),contentPosition:dn,width:200,children:(0,s.jsx)(x.IconButton,{name:"statusDot",variant:"secondary",transparent:!0,testID:"status-dot-button",onPress:_})},O)})]})}):(0,s.jsx)(i.Box,{spacingStart:3,spacingEnd:2,spacingVertical:2,children:(0,s.jsxs)(u.HStack,{spacingVertical:.5,justifyContent:"space-between",alignItems:"center",width:"100%",children:[(0,s.jsxs)(i.Box,{alignItems:"center",children:[(0,s.jsx)(i.Box,{spacingEnd:1,children:(0,s.jsx)(S.Pictogram,{dimension:"48x48",name:"supportChat",scaleMultiplier:.5,testID:"support-chat-pictogram"})}),(0,s.jsxs)(P.VStack,{justifyContent:"center",height:44,maxHeight:44,children:[(0,s.jsx)(h.TextHeadline,{as:"h3",children:o&&r?r.displayName:null!==(n=null===l||void 0===l?void 0:l.defaultBotName)&&void 0!==n?n:m(un.defaultBotTitle)}),g&&!p&&(0,s.jsx)(I.TextLabel2,{as:"p",color:"foregroundMuted",children:m(un.isTyping)})]})]}),(0,s.jsx)(i.Box,{children:p?(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsx)(x.IconButton,{name:"close",variant:"secondary",transparent:!0,onClick:w,testID:"close-button"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsx)(U.Dropdown,{ref:b,content:(0,s.jsx)(cn,{isDisabled:f,onCloseConversation:F}),contentPosition:dn,width:200,children:(0,s.jsx)(x.IconButton,{name:"statusDot",variant:"secondary",transparent:!0,testID:"status-dot-button",onPress:_})})}),(0,s.jsx)(i.Box,{alignItems:"center",children:(0,s.jsx)(x.IconButton,{name:"caretDown",variant:"secondary",transparent:!0,onClick:C,testID:"caret-down-button"})})]})})]})})})),fn=(0,m.vU)({cardTitle:{id:"ChatQueryFailedErrorFallback.cardTitle",defaultMessage:"This chat is currently unavailable.",description:"Title of card that appears when fetching chat details fails"},cardSubtitle:{id:"ChatQueryFailedErrorFallback.cardSubtitle",defaultMessage:"In the meantime, please visit the Help Center.",description:"Subtitle of card that appears when step-up authentication fails"},helpCenterCtaButton:{id:"ChatQueryFailedErrorFallback.helpCenterCtaButton",defaultMessage:"Go to Help Center",description:"Action to trigger page redirect to help.coinbase.com"},startNewChatCtaButton:{id:"ChatQueryFailedErrorFallback.startNewChatCtaButton",defaultMessage:"Start new chat",description:"Action to start new chat"},reloadPageCtaButton:{id:"ChatQueryFailedErrorFallback.reloadPageCtaButton",defaultMessage:"Reload page",description:"Action to reload page"}});function vn(){window.location.reload()}function mn(e){var n=e.conversationUuid,t=e.guestUserUuid,r=e.errorMessage,l=e.isStartNewChatLoading,c=void 0!==l&&l,d=e.onStartNewChatPress,p=(0,y.Z)().formatMessage,g=ye().layout,v=(0,o.NO)();return(0,a.useEffect)((function(){v.logError(new Error(null!==r&&void 0!==r?r:"User sees ChatQueryFailedErrorFallback component"),{context:"ChatQueryFailedErrorFallback",severity:"crash",isHandled:!0,conversationUuid:n,guestUserUuid:t,errorMessage:r})}),[n,r,v,t]),(0,s.jsxs)(De,{layout:g,isConversationClosed:!1,children:[(0,s.jsx)(gn,{conversationUuid:"",isConversationClosed:!1,config:null,isAgentActive:!1,isTyping:!1,agentParticipant:void 0,isClosingConversation:!1}),(0,s.jsx)(j.Divider,{}),(0,s.jsx)(i.Box,{position:"absolute",background:"backgroundOverlay",width:"100%",height:"100%",borderRadius:"roundedLarge",bordered:!1,zIndex:10,children:(0,s.jsx)(w.Card,{pin:"bottom",elevation:1,spacingVertical:3,spacingHorizontal:3,borderRadius:"roundedLarge",background:"background",children:(0,s.jsxs)(b.VStack,{gap:3,children:[(0,s.jsxs)(b.VStack,{gap:1,children:[(0,s.jsxs)(u.HStack,{alignItems:"center",gap:1,children:[(0,s.jsx)(f.Icon,{name:"error",size:"s",color:"negative",testID:"error-icon"}),(0,s.jsx)(_.TextTitle3,{as:"h3",color:"negative",children:p(fn.cardTitle)})]}),(0,s.jsx)(C.TextLabel2,{align:"center",as:"p",color:"foregroundMuted",children:p(fn.cardSubtitle)})]}),(0,s.jsxs)(b.VStack,{gap:2,width:"100%",children:[(0,s.jsx)(O.Button,{block:!0,variant:"secondary",to:sn(),children:p(fn.helpCenterCtaButton)}),d?(0,s.jsx)(O.Button,{block:!0,variant:"primary",loading:c,onPress:d,children:p(fn.startNewChatCtaButton)}):(0,s.jsx)(O.Button,{block:!0,variant:"primary",onPress:vn,children:p(fn.reloadPageCtaButton)})]})]})})})]})}var yn=20,bn=(0,m.vU)({cardTitle:{id:"ConnectionTroubleCard.cardTitle",defaultMessage:"Chatbot Connection Trouble",description:"Title of card that appears when chat gets disconected from server"},cardSubtitle:{id:"ConnectionTroubleCard.cardSubtitle",defaultMessage:"We\u2019re looking into it and will be back soon! In the meantime, please visit the Help Center.",description:"Subtitle of card that appears when chat gets disconected from server"},btnHelpCenterCta:{id:"ConnectionTroubleCard.btnHelpCenterCta",defaultMessage:"Go to Help Center",description:"Action to open new webpage with Help Center page"},btnCloseChat:{id:"ConnectionTroubleCard.btnCloseChat",defaultMessage:"Close Chat",description:"Action to close chat widget"}});function hn(e){var n=e.onCloseChat,t=e.onOpen,a=(0,y.Z)().formatMessage;return(0,r.FI)((function(){null===t||void 0===t||t()})),(0,s.jsx)(P.Box,{position:"absolute",background:"backgroundOverlay",width:"100%",height:"100%",borderRadius:"roundedLarge",bordered:!1,zIndex:10,children:(0,s.jsx)(w.Card,{pin:"bottom",elevation:1,spacingTop:3,spacingBottom:4,spacingHorizontal:3,borderRadius:"roundedLarge",children:(0,s.jsxs)(P.VStack,{gap:3,children:[(0,s.jsxs)(P.VStack,{gap:2,children:[(0,s.jsxs)(P.HStack,{alignItems:"center",gap:1,children:[(0,s.jsx)(f.Icon,{name:"error",size:"s",color:"negative",testID:"error-icon"}),(0,s.jsx)(I.TextTitle3,{as:"h3",color:"negative",children:a(bn.cardTitle)})]}),(0,s.jsx)(I.TextLabel2,{as:"p",color:"foregroundMuted",children:a(bn.cardSubtitle)})]}),(0,s.jsxs)(P.VStack,{gap:1,width:"100%",children:[(0,s.jsx)(O.Button,{block:!0,variant:"primary",to:sn(),children:a(bn.btnHelpCenterCta)}),(0,s.jsx)(O.Button,{block:!0,variant:"secondary",onPress:n,children:a(bn.btnCloseChat)})]})]})})})}function Cn(e,n,t){var a;if(n.participant&&!(0,r.Io)(null===(a=n.participant)||void 0===a?void 0:a.participantType)&&"MESSAGE_CONTENT"===n.type){var i,o,l,s=null===(i=(0,r.bv)("cb_chat_message_latency"))||void 0===i?void 0:i.startTime;if(s&&new Date(n.createTime).getTime()>s)(0,r.b7)("cb_chat_message_latency",e,se(se({},t),{},{participantType:null===(l=n.participant)||void 0===l?void 0:l.participantType}));var u,c=null===(o=(0,r.bv)("cb_chat_message_overall_latency"))||void 0===o?void 0:o.startTime;if(c&&new Date(n.createTime).getTime()>c)(0,r.b7)("cb_chat_message_overall_latency",e,se(se({},t),{},{participantType:null===(u=n.participant)||void 0===u?void 0:u.participantType}))}}var kn={borderTopLeftRadius:28,borderBottomLeftRadius:28},xn={borderRadius:"100%"},Sn=(0,a.memo)((function(e){var n=e.isVisible,t=e.unreadCount,r=e.onPress,o=(0,a.useMemo)((function(){return se({transitionDuration:"150ms",transform:"translateX(".concat(n?"0%":"150%",")")},kn)}),[n]);return(0,s.jsx)(i.Box,{position:"absolute",bottom:90,right:0,background:"transparent",dangerouslySetStyle:o,elevation:2,testID:"scroll-to-bottom",zIndex:9,children:(0,s.jsx)(p.Pressable,{backgroundColor:"background",borderColor:"transparent",style:kn,onPress:r,tabIndex:n?0:-1,children:(0,s.jsx)(i.Box,{spacing:.5,children:(0,s.jsxs)(u.HStack,{gap:1,alignItems:"center",justifyContent:"center",spacing:1,children:[(0,s.jsx)(i.Box,{borderColor:"primary",spacing:.5,height:24,width:24,justifyContent:"center",alignItems:"center",dangerouslySetStyle:xn,children:(0,s.jsx)(f.Icon,{color:"primary",size:"xs",name:"downArrow",testID:"down-arrow-icon"})}),(0,s.jsx)(d.DotCount,{count:t})]})})})})}));var jn=(0,a.memo)((function(e){var n=e.children,t=e.unreadMessageCount,o=e.bottomPadding,l=void 0===o?0:o,u=e.autoScrollKey,c=e.shouldRestoreScroll,d=e.onTopReached,p=e.onBottomReached,g=e.onScrollToEndPress,f=(0,a.useRef)(""),v=(0,a.useMemo)((function(){return{paddingBottom:l+16}}),[l]),m=function(e){var n=(null!==e&&void 0!==e?e:{}).onTopReached,t=(0,a.useRef)(null),i=(0,a.useRef)(null),o=de((0,a.useState)(!0),2),l=o[0],s=o[1],u=(0,a.useRef)(null),c=(0,a.useRef)(!1),d=(0,a.useRef)();(0,r.L8)((function(){clearTimeout(d.current)}));var p=(0,a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth",n=arguments.length>1?arguments[1]:void 0;if(i.current){var t=n?document.getElementById(n):i.current;null===t||void 0===t||t.scrollIntoView({behavior:e}),s(!0),c.current=!0,d.current=setTimeout((function(){c.current=!1}),1e3)}}),[]),g=(0,a.useCallback)((function(){var e,a,r=t.current;r&&(null===n||void 0===n?void 0:n())&&(u.current={contentHeight:null!==(e=null===r||void 0===r?void 0:r.scrollHeight)&&void 0!==e?e:0,scrollPosition:null!==(a=null===r||void 0===r?void 0:r.scrollTop)&&void 0!==a?a:0})}),[n]),f=(0,a.useCallback)((function(){if(t.current){var e=t.current;if(e.scrollTop<100&&g(),!c.current){var n=e.scrollTop+e.clientHeight,a=e.scrollHeight;s(a-n<=100)}}}),[g]),v=(0,a.useCallback)((function(){if(t.current&&u.current){var e=u.current,n=e.contentHeight,a=e.scrollPosition;t.current.scrollTop=a+t.current.scrollHeight-n-20,u.current=null}}),[]);return{scrollToBottom:p,scrollEl:t,scrollReferenceEl:i,isScrolledToBottom:l,handleScroll:f,restoreScroll:v,setIsScrolledToBottom:s}}({onTopReached:d}),y=m.scrollReferenceEl,h=m.scrollToBottom,C=m.isScrolledToBottom,k=m.handleScroll,x=m.scrollEl,S=m.restoreScroll,j=m.setIsScrolledToBottom;(0,a.useEffect)((function(){h("auto")}),[h]),(0,a.useEffect)((function(){c&&S()}),[c,S]),(0,a.useEffect)((function(){var e=f.current;f.current=u,u&&h("smooth",u),e&&!u&&j(!1)}),[u,h,j]),(0,a.useEffect)((function(){C&&(null===p||void 0===p||p())}),[C,p]);var E=(0,a.useCallback)((function(){h("smooth"),null===g||void 0===g||g()}),[h,g]);return(0,s.jsxs)(b.VStack,{flexGrow:1,position:"relative",overflow:"hidden",children:[(0,s.jsx)(Sn,{isVisible:!C,unreadCount:t,onPress:E}),(0,s.jsxs)(b.VStack,{ref:x,spacing:2,flexGrow:1,overflow:"auto",onScroll:k,gap:2,dangerouslySetStyle:v,children:[n,(0,s.jsx)(i.Box,{ref:y,width:"100%",height:"0"},"scroll-reference")]},"message-scroll-container")]})})),En={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MessageTypeToUIRendererFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{args:null,kind:"FragmentSpread",name:"MessageBubbleFragment"},{args:null,kind:"FragmentSpread",name:"ParticipantBubbleFragment"}],type:"ConversationEvent",abstractKey:null,hash:"3c416e8222651b6b516edc008362ac53"},Tn={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ParticipantBubbleFragment",selections:[{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null}],type:"ConversationEvent",abstractKey:null,hash:"d9b9fbda45a93053f171fc29bcc3b470"},On=(0,m.vU)({today:{id:"ChatSupport.MessageBubble.today",defaultMessage:"TODAY",description:"To show when the date is today's date"},now:{id:"ChatSupport.MessageBubble.now",defaultMessage:"Now",description:"To show when the time is less than 1 min"},failedToSend:{id:"ChatSupport.MessageBubble.failedToSend",defaultMessage:"Message failed to send. Click to retry.",description:"Shown when a message was not send to backend due to an error."},participantJoinedTitle:{id:"ChatSupport.MessageBubble.participantJoinedTitle",defaultMessage:"{agentName} entered the chat",description:"Title message prefixed with agent name when chat is successfully transferred to an agent"},participantJoinedMessage:{id:"ChatSupport.MessageBubble.participantJoinedMessage",defaultMessage:"Your support agent is ready to assist you",description:"Prefixed message used as subtitle when an agent joins the chat"}});function wn(){var e=(0,F.useSpectrum)(),n=(0,a.useMemo)((function(){return{backgroundColor:(0,M.paletteValueToRgbaString)("gray0",e),borderColor:(0,M.paletteValueToRgbaString)("green40",e),borderRadius:24}}),[e]);return(0,s.jsx)(P.Box,{bordered:!0,spacing:1,justifyContent:"center",alignItems:"center",dangerouslySetStyle:n,children:(0,s.jsx)(f.Icon,{name:"chatBotAgent",color:"primary",size:"m"})})}function _n(e){var n=e.children,t=ce(e,ie),r=(0,F.useSpectrum)(),i=(0,a.useMemo)((function(){return{borderColor:(0,M.paletteValueToRgbaString)("green40",r)}}),[r]);return(0,s.jsx)(P.VStack,se(se({},t),{},{spacingHorizontal:1,children:(0,s.jsx)(P.HStack,{spacingVertical:1,spacingHorizontal:2,gap:1,flexGrow:1,alignItems:"center",borderRadius:"tooltip",bordered:!0,justifyContent:"space-between",dangerouslySetStyle:i,background:"background",children:n})}))}var Un=(0,a.memo)((function(e){var n,t=e.event,a=(0,y.Z)().formatMessage,i=(0,T.Jc)(Tn,t);return Boolean(i.participant&&(0,r.$1)(i.participant.participantType))&&null!==(n=i.participant)&&void 0!==n&&n.displayName?(0,s.jsxs)(_n,{spacingBottom:2,testID:"participant-bubble",children:[(0,s.jsxs)(P.VStack,{flexShrink:1,gap:.5,spacingEnd:1,children:[(0,s.jsx)(I.TextLabel1,{as:"p",testID:"participant-bubble-title",children:a(On.participantJoinedTitle,{agentName:i.participant.displayName})}),(0,s.jsx)(I.TextLabel2,{as:"p",color:"foregroundMuted",testID:"participant-bubble-name",children:a(On.participantJoinedMessage)})]}),(0,s.jsx)(wn,{})]}):null})),Pn=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MessageBubbleFragment",selections:[e,{alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]}],type:"ConversationEvent",abstractKey:null}}();Pn.hash="e52eb32b809d0cb96674a1f4de03228f";var In="cb-chat-state",Fn=(0,J.X3)("cb-chat-sdk",1,{upgrade:function(e){e.objectStoreNames.contains(In)||e.createObjectStore(In,{keyPath:"id"})}});var Mn=function(){var e=We();return{get:async function(n){try{var t,a=await Fn;return null===(t=await a.get(In,n))||void 0===t?void 0:t.value}catch(r){return r instanceof Error&&e.logError(r,{context:"async_client_storage",severity:"error",isHandled:!0,key:n}),Promise.reject(r)}},set:async function(n,t){try{if(""===t||null===t||void 0===t)throw new Error("Invalid value");var a=await Fn;return await a.put(In,{id:n,value:t})}catch(r){return r instanceof Error&&e.logError(r,{context:"async_client_storage",severity:"error",isHandled:!0,key:n}),Promise.reject(r)}},delete:async function(n){try{var t=await Fn;return await t.delete(In,n)}catch(a){return a instanceof Error&&e.logError(a,{context:"async_client_storage",severity:"error",isHandled:!0,key:n}),Promise.reject(a)}},clearStore:async function(){try{var n=await Fn;return await n.clear(In)}catch(t){return t instanceof Error&&e.logError(t,{context:"async_client_storage",severity:"error",isHandled:!0}),Promise.reject(t)}},getKeys:async function(){try{var n=await Fn;return await n.getAllKeys(In)}catch(t){return t instanceof Error&&e.logError(t,{context:"async_client_storage",severity:"error",isHandled:!0}),Promise.reject(t)}}}}();async function Dn(e){try{var n,t=await Mn.get("ACCORDION_ACTIVE_ITEM_STORE");return null!==(n=JSON.parse(t)[e])&&void 0!==n?n:null}catch(a){return null}}async function Kn(e,n){try{var t=await Mn.get("ACCORDION_ACTIVE_ITEM_STORE"),a=t?JSON.parse(t):{};a[e]===n?delete a[e]:a[e]=n,await Mn.set("ACCORDION_ACTIVE_ITEM_STORE",JSON.stringify(a))}catch(r){}}function Ln(e,n){e&&We().logError(e,{isHandled:!0,severity:"critical",context:"ui_element"}),n.length&&(0,l.HR)({metricName:"cb.chat_support.uielement.parseerror",metricType:l.t0.count,value:1,tags:n.reduce((function(e,n){return e[n.type]="1",e}),{})})}var Bn=(0,a.memo)((function(e){var n=e.items,t=e.storageKey,a=(0,r.iq)({items:n,storageKey:t,getStorageActiveKey:Dn,setStorageActiveKey:Kn}),o=a.activeKey,l=a.onItemPress;return"undefined"!==typeof o&&n.length?(0,s.jsx)(u.HStack,{testID:"ui-element-accordion-".concat(t),spacingStart:2,spacingVertical:2,children:(0,s.jsx)(i.Box,{bordered:!0,borderRadius:"tooltip",children:(0,s.jsx)(D.U,{defaultActiveKey:o,onItemPress:l,children:n.map((function(e,n){var t,a=null!==(t=e.key)&&void 0!==t?t:n.toString();return(0,s.jsx)(K.Q,{testID:"accordion-item-".concat(a),title:e.title,itemKey:a,children:(0,s.jsx)(i.Box,{testID:"accordion-content-".concat(a),children:(0,s.jsx)(k.TextBody,{as:"p",color:"secondaryForeground",overflow:"break",children:(0,s.jsx)(we,{text:e.content,linkColor:"secondaryForeground",renderTokens:!0})})})},a)}))})})}):null})),An=(0,a.memo)((function(e){var n=e.payload,t=e.messageKey,i=(0,a.useMemo)((function(){return(0,r.uX)({payload:n,onError:Ln})}),[n]);return(0,s.jsx)(Bn,{items:i,storageKey:t})})),Nn=(0,a.memo)((function(e){var n=e.type,t=e.payload,a=e.messageKey;return n&&t&&"accordion"===n?(0,s.jsx)(An,{payload:t,messageKey:a}):null})),Rn=(0,a.memo)((function(e){var n=e.content,t=e.isUser,a=e.testID;return(0,s.jsx)(i.Box,{testID:a,children:(0,s.jsx)(k.TextBody,{as:"p",color:t?"secondaryForeground":"secondary",overflow:"break",children:(0,s.jsx)(we,{text:n,linkColor:t?"secondaryForeground":"secondary",renderTokens:!t})})})})),Vn=(0,a.memo)((function(e){var n=e.isPendingMessage,t=e.createTime,r=e.isUser,i=(0,a.useMemo)((function(){return new Date(t)}),[t]),o=(0,y.Z)().formatTime;return(0,s.jsx)(u.HStack,{spacingVertical:.5,spacingStart:r?0:5,justifyContent:r?"flex-end":"flex-start",children:n?(0,s.jsx)(v.$,{testID:"message-bubble-pending",size:2}):(0,s.jsx)(B.TextLegal,{as:"span",color:"foregroundMuted",children:o(i,{hour:"2-digit",minute:"2-digit",hour12:!0})})})})),Hn={transform:"scale(0.75)"};function Wn(e){var n=e.children,t=ce(e,oe);return(0,s.jsx)(i.Box,se(se({height:32,width:32,alignItems:"center",justifyContent:"center",bordered:!0,borderRadius:"round",borderColor:"line"},t),{},{children:n}))}function zn(e){var n=e.participantLabel,t=e.testID,a=(0,g.useLogoMark)({size:32}),r=a.viewBox,i=a.path,o=a.height,l=a.width;return(0,s.jsx)(Wn,{testID:t,accessibilityLabel:n,background:"primary",children:(0,s.jsx)("svg",{viewBox:r,width:l,height:o,style:Hn,children:(0,s.jsx)("path",{d:i,fill:"white"})})})}function $n(e){var n=e.participantLabel,t=e.testID;return(0,s.jsx)(Wn,{testID:t,accessibilityLabel:n,background:"background",spacing:1,children:(0,s.jsx)(f.Icon,{size:"m",name:"chatBotAgent"})})}function Gn(e){var n=e.participantType,t=void 0===n?"":n,a=e.participantLabel,i=e.testID;return(0,r.ej)(t)?(0,s.jsx)(zn,{participantLabel:a,testID:i}):(0,r.$1)(t)?(0,s.jsx)($n,{participantLabel:a,testID:i}):null}var qn=(0,a.memo)((function(e){var n=e.isSelected,t=e.title,r=e.index,i=e.onSelect,o=(0,a.useCallback)((function(){return null===i||void 0===i?void 0:i(r)}),[i,r]),l=(0,a.useCallback)((function(e){e.shiftKey||e.altKey||e.metaKey||e.ctrlKey||("Enter"===e.key?(e.preventDefault(),n&&(null===i||void 0===i||i(r,!0))):" "===e.key&&(e.preventDefault(),n||null===i||void 0===i||i(r)))}),[n,r,i]);return(0,s.jsx)(V.u,{action:(0,s.jsx)(H.Radio,{tabIndex:-1,checked:n,onChange:o}),title:t,onPress:o,onKeyDown:l})})),Qn=(0,a.memo)((function(e){var n=e.label,t=e.isOpen,r=e.onPress,i=(0,a.useRef)(!1),o=(0,W.useRotateAnimation)(-180),l=o.rotateAnimationRef,c=o.animateClockwise,d=o.animateCounterClockwise,g=(0,a.useCallback)((function(e){i.current=!0,null===r||void 0===r||r(e)}),[r]);return(0,a.useEffect)((function(){i.current&&(t?c():d())}),[c,d,t]),(0,s.jsx)(p.Pressable,{borderRadius:"input",backgroundColor:"background",as:"button",borderWidth:"input",borderColor:"lineHeavy",onPress:g,children:(0,s.jsxs)(u.HStack,{spacingVertical:1,spacingStart:2,justifyContent:"space-between",alignItems:"center",children:[(0,s.jsx)(k.TextBody,{color:"foregroundMuted",as:"span",overflow:"truncate",children:n}),(0,s.jsx)(z.InputIcon,{ref:l,name:"caretDown",color:"foregroundMuted"},"input-icon")]})})})),Zn=(0,m.vU)({submitLabel:{id:"PickListModalSelect.submitLabel",defaultMessage:"Submit",description:"Submit label for button"},modalFallbackTitle:{id:"PickListModalSelect.modalFallbackTitle",defaultMessage:"Select an item",description:"Fallback title for select modal"}}),Jn=(0,a.memo)((function(e){var n=e.items,t=e.title,r=e.onItemSubmit,o=de((0,a.useState)(-1),2),l=o[0],u=o[1],c=de((0,a.useState)(!1),2),d=c[0],p=c[1],g=(0,y.Z)().formatMessage,f=(0,a.useCallback)((function(){p(!0)}),[]),v=(0,a.useCallback)((function(){u(-1),p(!1)}),[]),m=(0,a.useCallback)((function(){var e;if(-1!==l){var t=n[l],a=null!==(e=null===t||void 0===t?void 0:t.messageToPublish)&&void 0!==e?e:null===t||void 0===t?void 0:t.label;v(),a&&(null===r||void 0===r||r(a))}}),[v,n,r,l]),b=(0,a.useCallback)((function(e,n){u(e),n&&m()}),[m]),h=null!==t&&void 0!==t?t:g(Zn.modalFallbackTitle);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Qn,{label:h,isOpen:d,onPress:f}),(0,s.jsxs)(A.u,{visible:d,onRequestClose:v,children:[(0,s.jsx)(R.x,{title:h}),(0,s.jsx)(i.Box,{flexDirection:"column",flexGrow:1,overflow:"auto",children:n.map((function(e,n){var t=n===l,a=n;return(0,s.jsx)(qn,{isSelected:t,index:n,title:e.label,onSelect:b},a)}))}),(0,s.jsx)(N.m,{primaryAction:(0,s.jsx)(O.Button,{testID:"picklist-submit-btn",disabled:-1===l,onPress:m,block:!0,children:g(Zn.submitLabel)})})]})]})})),Yn={borderBottomRightRadius:0},Xn=(0,a.memo)((function(e){var n=e.title,t=e.message,a=e.items,r=e.messageKey,o=e.onItemSubmit;return a.length?(0,s.jsx)(u.HStack,{width:"100%",testID:"pick-list-".concat(r),justifyContent:"flex-end",spacingTop:2,children:(0,s.jsxs)(b.VStack,{spacing:2,flexShrink:1,borderRadius:"tooltip",background:"backgroundAlternate",width:"80%",gap:1,dangerouslySetStyle:Yn,children:[t?(0,s.jsx)(i.Box,{testID:"picklist-message-".concat(r),children:(0,s.jsx)(k.TextBody,{as:"p",color:"secondaryForeground",overflow:"break",children:(0,s.jsx)(we,{text:t,linkColor:"secondaryForeground",renderTokens:!0})})}):null,(0,s.jsx)(Jn,{title:n,items:a,messageKey:r,onItemSubmit:o})]})}):null})),et=(0,a.memo)((function(e){var n=e.items,t=e.payload,i=e.messageKey,o=e.onSubmit,l=(0,a.useMemo)((function(){return(0,r.FZ)({payload:null!==t&&void 0!==t?t:"",onError:Ln})}),[t]),u=(0,a.useMemo)((function(){return(null!==n&&void 0!==n?n:[]).filter(Boolean)}),[n]);return(0,s.jsx)(Xn,{messageKey:i,title:l.title,message:l.message,items:u,onItemSubmit:o})})),nt=(0,a.memo)((function(e){var n=e.testID,t=e.text,r=e.onPress,o=de((0,a.useState)(!1),2),l=o[0],u=o[1],c=(0,a.useCallback)((function(){return u(!0)}),[]),d=(0,a.useCallback)((function(){return u(!1)}),[]);return(0,s.jsx)(p.Pressable,{as:"button",testID:n,backgroundColor:l?"primary":"background",borderRadius:"standard",borderColor:"line",borderWidth:"button",onPress:r,onMouseDown:c,onMouseUp:d,onMouseLeave:d,children:(0,s.jsx)(i.Box,{spacingVertical:1,spacingHorizontal:2,children:(0,s.jsx)($.TextLabel1,{as:"span",color:l?"primaryForeground":"primary",children:t})})})})),tt=(0,a.memo)((function(e){var n=e.testID,t=e.text,r=e.link,o=de((0,a.useState)(!1),2),l=o[0],u=o[1],c=(0,a.useCallback)((function(){return u(!0)}),[]),d=(0,a.useCallback)((function(){return u(!1)}),[]);return(0,s.jsx)(p.Pressable,{as:"a",href:null!==r&&void 0!==r?r:"",rel:"noopener noreferrer",testID:n,backgroundColor:l?"primary":"background",borderRadius:"standard",borderColor:"line",borderWidth:"button",onMouseDown:c,onMouseUp:d,onMouseLeave:d,children:(0,s.jsx)(i.Box,{spacingVertical:1,spacingHorizontal:2,children:(0,s.jsx)($.TextLabel1,{as:"span",color:l?"primaryForeground":"primary",children:t})})})}));var at=(0,a.memo)((function(e){var n=e.testID,t=e.reply,r=e.onReplyPress,i=ye().onSignInPress,o=(0,a.useCallback)((function(){var e;e="SIGN_IN_QUICK_REPLY",Mn.set("UNAUTHENTICATED_STEP_UP_SOURCE",e),null===i||void 0===i||i()}),[i]),l=(0,a.useCallback)((function(){var e;null===r||void 0===r||r(null!==(e=t.messageToPublish)&&void 0!==e?e:"")}),[t,r]);return"http://signin_button"===t.link?(0,s.jsx)(nt,{testID:n,text:t.label,onPress:o}):t.link?(0,s.jsx)(tt,{testID:n,link:t.link,text:t.label}):(0,s.jsx)(nt,{testID:n,text:t.label,onPress:l})})),rt={gap:"12px"},it=(0,a.memo)((function(e){var n=e.replies,t=e.testID,a=e.extraElementType,r=e.extraElementPayload,i=e.messageKey,o=e.onReplyPress;return"picklist"===a?(0,s.jsx)(et,{messageKey:i,payload:r,items:n,onSubmit:o}):(0,s.jsx)(u.HStack,{testID:t,justifyContent:"flex-end",flexWrap:"wrap",dangerouslySetStyle:rt,spacingTop:2,children:null===n||void 0===n?void 0:n.map((function(e,n){return e?(0,s.jsx)(at,{reply:e,testID:"".concat(t,"-").concat(n),onReplyPress:o},e.label):null}))})})),ot={borderBottomLeftRadius:0},lt={borderBottomRightRadius:0};function st(e){var n=e.createTime,t=e.id,o=e.uuid,l=e.isFailed,u=e.participantDisplayName,c=e.participantType,d=e.showQuickReplies,g=e.messageText,v=e.isPendingMessage,m=void 0===v||v,h=e.replies,k=e.onReplyPress,x=e.conversationId,S=e.extraElementType,j=e.extraElementPayload,E=(0,y.Z)().formatMessage,T=ye().mode,O=void 0===T?"LOGGED_IN":T,w=(0,r.Io)(c),_=w&&l,U=(0,a.useMemo)((function(){return w?"backgroundAlternate":"primary"}),[w]),I=(0,a.useCallback)((function(){g&&(null===k||void 0===k||k(g,t)),Ce("cbchat_send_message_retry",x,{message_id:t,unauth:"LOGGED_OUT"===O})}),[g,x,t,O,k]),F=(0,a.useCallback)((function(e){null===k||void 0===k||k(e,o)}),[k,o]),M=_?{flexShrink:1}:{flexGrow:1},D=(0,s.jsxs)(b.VStack,{id:"event-".concat(t),children:[(0,s.jsxs)(b.VStack,{spacingEnd:w?void 0:6,spacingStart:w?6:void 0,testID:"message-bubble",children:[(0,s.jsxs)(P.HStack,{alignSelf:w?"flex-end":"flex-start",width:w?void 0:"90%",alignItems:w?"center":"flex-end",gap:1,children:[!w&&(0,s.jsx)(Gn,{testID:"participant-".concat(t),participantType:c,participantLabel:u}),(0,s.jsxs)(b.VStack,se(se({},M),{},{children:[(0,s.jsx)(b.VStack,{spacing:2,flexShrink:1,flexGrow:1,testID:"message-container-".concat(t),borderRadius:"tooltip",background:U,alignSelf:w?"flex-end":"flex-start",dangerouslySetStyle:w?lt:ot,children:(0,s.jsx)(Rn,{isUser:w,content:null!==g&&void 0!==g?g:""})}),!!_&&(0,s.jsx)(i.Box,{alignItems:"flex-end",spacingBottom:.5,children:(0,s.jsx)(C.TextLabel2,{as:"p",color:"negative",children:E(On.failedToSend)})})]})),!!_&&(0,s.jsx)(f.Icon,{testID:"failed-icon",spacingStart:.5,spacingBottom:2,color:"primary",name:"undo",size:"s"})]}),!_&&(0,s.jsx)(Vn,{isPendingMessage:m,createTime:n,isUser:w})]}),!w&&(0,s.jsx)(Nn,{messageKey:o,type:S,payload:j}),d?(0,s.jsx)(it,{testID:"message-quick-replies-".concat(t),messageKey:o,replies:null!==h&&void 0!==h?h:null,extraElementType:S,extraElementPayload:j,onReplyPress:F}):null]});return _?(0,s.jsx)(p.Pressable,{testID:"message-pressable-".concat(t),backgroundColor:"transparent",onPress:I,children:D}):D}function ut(e){var n=e.id,t=e.messageText,a=void 0===t?"":t;return(0,s.jsx)(C.TextLabel2,{id:"event-".concat(n),testID:"system-message",as:"p",color:"foregroundMuted",spacingHorizontal:2,spacingVertical:1,align:"center",overflow:"wrap",children:(0,s.jsx)(we,{text:a})})}var ct=Pn,dt=(0,a.memo)((function(e){var n,t,i=e.event,o=e.showQuickReplies,l=e.conversationId,u=e.onReplyPress,c=(0,T.Jc)(ct,i),d=c.id,p=c.uuid,g=c.createTime,f=c.messageContent,v=c.participant,m=c.hasUploadFailed,y=c.isBeingUploaded,b=(0,a.useCallback)((function(e){null===u||void 0===u||u(e,p)}),[u,p]),h=null===v||void 0===v?void 0:v.participantType;return(0,r.Qj)(h)?(0,s.jsx)(ut,{id:d,messageText:null!==(t=null===f||void 0===f?void 0:f.message)&&void 0!==t?t:""}):(0,s.jsx)(st,{id:d,uuid:p,showQuickReplies:o,createTime:g,messageText:null!==(n=null===f||void 0===f?void 0:f.message)&&void 0!==n?n:"",replies:null===f||void 0===f?void 0:f.replies,participantType:h,participantDisplayName:null===v||void 0===v?void 0:v.displayName,isFailed:!!m,isPendingMessage:!!y,onReplyPress:b,conversationId:l,extraElementType:null===f||void 0===f?void 0:f.extraElementType,extraElementPayload:null===f||void 0===f?void 0:f.extraElementPayload})})),pt=En,gt=(0,a.memo)((function(e){var n=e.event,t=e.conversationId,a=e.onReplyPress,r=e.showQuickReplies,i=(0,T.Jc)(pt,n);switch(i.type){case"MESSAGE_CONTENT":return(0,s.jsx)(dt,{event:i,conversationId:t,onReplyPress:a,showQuickReplies:r});case"PARTICIPANT_JOINED":return(0,s.jsx)(Un,{event:i});default:return null}})),ft=2e3,vt=(0,m.vU)({inputPlaceholder:{id:"ChatSupport.UserInput.inputPlaceholder",defaultMessage:"Type your message here",description:"Placeholder text to show in user input"}});function mt(e){var n=e.input,t=e.sendButton,r=e.characterLimitHelpText,o=(0,G.usePaletteValueToRgbaString)(),l=(0,a.useMemo)((function(){return{WebkitBackdropFilter:"blur(16px)",backdropFilter:"blur(16px)",backgroundColor:o(["gray0",.7])}}),[o]);return(0,s.jsxs)(u.HStack,{gap:1,spacingHorizontal:2,spacingVertical:2,dangerouslySetStyle:l,children:[(0,s.jsx)(i.Box,{flexGrow:1,children:n}),(0,s.jsxs)(b.VStack,{justifyContent:"space-between",children:[r,(0,s.jsx)(q.Spacer,{}),t]})]})}var yt={resize:"none"};function bt(e){var n,t,a,r,i;if(e){var o=e.scrollHeight,l=null===(n=document.defaultView)||void 0===n?void 0:n.getComputedStyle(e);if(l){var s=null!==(t=Number(null===(a=l["font-size"])||void 0===a?void 0:a.replace("px","")))&&void 0!==t?t:12,u=function(e,n){return"number"===typeof e?e:"normal"===e?1.2*n:Number(e.replace("px",""))}(l["line-height"],s)/s,c=null!==(r=2*Number(null===(i=l["padding-block"])||void 0===i?void 0:i.replace("px","")))&&void 0!==r?r:12;if(!(s<=0))return Math.ceil((o/u-c)/s)}}}function ht(e){var n=e.maxNumberOfLines,t=void 0===n?1:n,r=e.value,i=void 0===r?"":r,o=e.placeholder,l=e.disabled,u=e.onChange,c=e.onKeyDown,d=(0,a.useRef)(null),p=de((0,a.useState)(1),2),g=p[0],f=p[1],v=de((0,a.useState)(!1),2),m=v[0],y=v[1],b=de((0,a.useState)(""),2),h=b[0],C=b[1],k=ye().layout,x=(0,a.useCallback)((function(){y(!0)}),[y]);return(0,a.useEffect)((function(){var e,n,a,r,o;h.length<i.length?(f((a=null!==(e=bt(null!==(n=d.current)&&void 0!==n?n:void 0))&&void 0!==e?e:0,r=1,o=t,Math.min(Math.max(a,r),o))),C(i)):h.length>i.length&&(f(1),C(""))}),[t,i,h]),(0,a.useEffect)((function(){var e,n;"mobile"===k?m&&(null===(e=d.current)||void 0===e||e.focus()):null===(n=d.current)||void 0===n||n.focus()}),[l,m,k]),(0,s.jsx)(Z.TextInput,{ref:d,compact:!0,borderRadius:g>1?"input":"search",inputNode:(0,s.jsx)(Q.NativeTextArea,{compact:!0,wrap:"soft",rows:g,style:yt,maxLength:ft,placeholder:o,value:i,onChange:u,onKeyDown:c,onClick:x})})}function Ct(e){var n=e.disabled,t=e.loading,a=e.onSendMessage;return(0,s.jsx)(x.IconButton,{testID:"user-input-send-btn",transparent:!0,name:"paperAirplane",variant:"primary",disabled:n,loading:t,onClick:a})}var kt=(0,a.memo)((function(e){var n=e.inputText,t=void 0===n?"":n,r=e.loading,i=e.onChangeText,o=e.onSendMessage,l=(0,y.Z)().formatMessage,u=(0,a.useCallback)((function(e){null===i||void 0===i||i(e.target.value)}),[i]),c=t.trim(),d=(0,a.useCallback)((function(e){if("Enter"===e.key&&!e.shiftKey){if(e.preventDefault(),r)return;c.length>0&&c.length<=ft&&(null===o||void 0===o||o())}}),[r,o,c]);return(0,s.jsx)(mt,{input:(0,s.jsx)(ht,{maxNumberOfLines:5,placeholder:l(vt.inputPlaceholder),value:t,disabled:r,onChange:u,onKeyDown:d}),characterLimitHelpText:t.length>=1800?(0,s.jsxs)(B.TextLegal,{as:"p",color:t.length>=ft?"negative":"foregroundMuted",children:[t.length,"/",ft]}):void 0,sendButton:c.length>0?(0,s.jsx)(Ct,{disabled:0===c.length||c.length>=ft||r,loading:r,onSendMessage:o}):void 0})})),xt=(0,m.vU)({cardTitle:{id:"ChatClosedCard.cardTitle",defaultMessage:"This chat is now closed",description:"Title of card that appears when chat gets closed"},cardSubtitle:{id:"ChatClosedCard.cardSubtitle",defaultMessage:"Need help with something else?",description:"Subtitle of card that appears when chat gets closed"},btnNewChat:{id:"ChatClosedCard.btnNewChat",defaultMessage:"Start new chat",description:"Action to start new chat"},newChatErrorMessage:{id:"ChatClosedCard.newChatErrorMessage",defaultMessage:"Something went wrong. Please refresh the page, or try again later.",description:'Error message to indicate "Start new chat" failed'}});function St(e){var n=e.conversationCreationStatus,t=e.onCreateNewConversation,a=(0,y.Z)().formatMessage;return(0,s.jsx)(w.Card,{pin:"bottom",elevation:1,spacingVertical:3,spacingHorizontal:3,background:"backgroundAlternate",children:(0,s.jsxs)(P.VStack,{gap:3,children:[(0,s.jsxs)(P.VStack,{gap:1,children:[(0,s.jsx)(I.TextLabel1,{align:"center",as:"p",children:a(xt.cardTitle)}),(0,s.jsx)(I.TextLabel2,{align:"center",as:"p",color:"foregroundMuted",children:a(xt.cardSubtitle)})]}),(0,s.jsxs)(P.VStack,{gap:1,width:"100%",children:["FAILED"===n&&(0,s.jsx)(I.TextLegal,{align:"center",as:"p",color:"negative",children:a(xt.newChatErrorMessage)}),(0,s.jsx)(O.Button,{testID:"start-newchat-button",loading:"LOADING"===n,block:!0,variant:"primary",onPress:t,children:a(xt.btnNewChat)})]})]})})}function jt(e){var n=e.query,t=e.conversationUuid,r=e.after,i=e.eventsConnectionId,l=e.guestUserUuid,s=Ye().triggerQueryRefetch,u=de((0,a.useState)(!0),2),c=u[0],d=u[1],p=de((0,a.useState)(0),2),g=p[0],f=p[1],v=(0,a.useCallback)((function(){f((function(e){return e+1}))}),[]),m=(0,o.NO)(),y=(0,a.useMemo)((function(){return{subscription:n,variables:{input:{conversationUuid:t,after:r,guestUserUuid:l},connections:i?[i]:[]},onNext:function(e){var n,a;if(e){var r=null===(n=e.event)||void 0===n||null===(a=n.node)||void 0===a?void 0:a.errorData;"SubscriptionError"===(null===r||void 0===r?void 0:r.type)&&"Conversation Closed"===(null===r||void 0===r?void 0:r.message)&&(m.logError(new Error(r.message),{context:"event_subscriber",severity:"error",isHandled:!0,conversationUuid:t,unauth:!!l,errorPayloadType:r.type}),s())}},onError:function(e){m.logError(e,{context:"event_subscriber",severity:"error",isHandled:!0,conversationUuid:t,unauth:!!l}),g<5?v():d(!1)},onCompleted:function(){m.logError(new Error("Disconnect cleanly triggered from server"),{context:"event_subscriber",severity:"error",isHandled:!0,conversationUuid:t,unauth:!!l}),g<5?v():d(!1)}}}),[t,l,i,g,v,m]);return(0,T.mU)(y),c}function Et(){var e=de((0,a.useState)(window.navigator.onLine),2),n=e[0],t=e[1];return(0,a.useEffect)((function(){var e=function(){return t(!0)},n=function(){return t(!1)};return window.addEventListener("online",e),window.addEventListener("offline",n),function(){window.removeEventListener("online",e),window.removeEventListener("offline",n)}}),[]),n}function Tt(){var e=de((0,a.useState)("visible"===document.visibilityState),2),n=e[0],t=e[1];return(0,a.useEffect)((function(){var e,n=function(){return"visible"===document.visibilityState?(clearTimeout(e),void t(!0)):(clearTimeout(e),void(e=setTimeout((function(){return t(!1)}),6e4)))};return window.addEventListener("visibilitychange",n),function(){clearTimeout(e),window.removeEventListener("visibilitychange",n)}}),[]),n}async function Ot(){return Promise.allSettled([Mn.get("UNAUTHENTICATED_CONVERSATION_UUID"),Mn.get("UNAUTHENTICATED_GUEST_USER_UUID"),Mn.get("UNAUTHENTICATED_STEP_UP_SOURCE")]).then((function(e){var n=de(e,3),t=n[0],a=n[1],r=n[2],i="fulfilled"===t.status?t.value:"",o="fulfilled"===a.status?a.value:"",l="fulfilled"===r.status?r.value:"";return i&&o?{conversationUuid:i,guestUserUuid:o,stepUpAuthSource:l}:{conversationUuid:"",guestUserUuid:"",stepUpAuthSource:""}}))}async function wt(){await Promise.all([Mn.delete("UNAUTHENTICATED_CONVERSATION_UUID"),Mn.delete("UNAUTHENTICATED_GUEST_USER_UUID"),Mn.delete("UNAUTHENTICATED_STEP_UP_SOURCE")])}},19310:function(e,n,t){t.d(n,{A:function(){return je}});var a=t(2784),r=t(21948),i=t(53077),o=t(88410),l=t(1136),s=t(65612),u=t(49177),c=t(83112),d=t(50117),p=t(52322),g=t(48972),f=t(65060),v=t(94087),m=t(59508),y=t(29904),b=t(55873);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function C(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach((function(n){S(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function S(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==h(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==h(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===h(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function j(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,o,l=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=i.call(t)).done)&&(l.push(a.value),l.length!==n);s=!0);}catch(c){u=!0,r=c}finally{try{if(!s&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return l}}(e,n)||E(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,n){if(e){if("string"===typeof e)return T(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,n):void 0}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var O=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null}],r={kind:"InlineFragment",selections:a,type:"BadRequestError",abstractKey:null},i={kind:"InlineFragment",selections:a,type:"Error",abstractKey:"__isError"},o={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useCreateUnauthenticatedConversationMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedConversation",plural:!1,selections:[t,r,i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[{kind:"RequiredField",field:o,action:"THROW",path:"createUnauthenticatedConversation.conversation.uuid"},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"creator",plural:!1,selections:[o],storageKey:null},action:"THROW",path:"createUnauthenticatedConversation.conversation.creator"}],storageKey:null}],type:"CreateUnauthenticatedConversationSuccess",abstractKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useCreateUnauthenticatedConversationMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedConversation",plural:!1,selections:[t,r,i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[o,{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"creator",plural:!1,selections:[o,l],storageKey:null},l],storageKey:null}],type:"CreateUnauthenticatedConversationSuccess",abstractKey:null}],storageKey:null}]},params:{cacheID:"e6706b050daa69126f892636a1389781",id:null,metadata:{},name:"useCreateUnauthenticatedConversationMutation",operationKind:"mutation",text:"mutation useCreateUnauthenticatedConversationMutation(\n  $input: CreateUnauthenticatedConversationInput!\n) {\n  createUnauthenticatedConversation(input: $input) {\n    __typename\n    ... on BadRequestError {\n      message\n      code\n    }\n    ... on Error {\n      __isError: __typename\n      message\n      code\n    }\n    ... on CreateUnauthenticatedConversationSuccess {\n      conversation {\n        uuid\n        creator {\n          uuid\n          id\n        }\n        id\n      }\n    }\n  }\n}\n"}}}();O.hash="387a25dbe785201a1c54d2cbb4196d34";var w=O;function _(e,n){(0,r.b)("cb_chat_create_conversation",n,{status:e?"success":"failure",action:l.Us.view,componentType:l.re.button,unauth:!0})}var U=(0,u.vU)({welcomeMessage:{id:"ChatWidgetFreshEntry.defaultWelcomeMessage",defaultMessage:"Hi \ud83d\udc4b\ud83c\udffb, I\u2019m your Coinbase Assistant. Is there anything I can help you with today?",description:"Welcome message shown on Chat widget button for unauthenticated users"},errorMessage:{id:"ChatWidgetFreshEntry.errorMessage",defaultMessage:"Something went wrong. Please refresh the page, or try again later.",description:'Error message indicating that "Start new chat" failed for unauthenticated users'}});function P(e){var n=e.loading,t=e.error,i=void 0!==t&&t,o=e.onPress,s=(0,c.Z)().formatMessage,u=(0,r.j)().greetingMessage,g=(0,a.useCallback)((function(){(0,r.b)("cb_chat_entry_press",null,{type:"new",action:l.Us.click,componentType:l.re.button,unauth:!0}),(0,d.ZD)("cb_chat_starting_latency","new-chat-start-button","new",{unauth:!0}),o()}),[o]);(0,a.useEffect)((function(){(0,r.y)("cb_chat_entry_impression",{componentType:l.re.button,action:l.Us.view,chat_status:"new",unauth:!0})}),[]);var f=(0,a.useMemo)((function(){return i?s(U.errorMessage):"undefined"!==typeof u?u:s(U.welcomeMessage)}),[i,s,u]);return(0,p.jsx)(r.z,{messagePromptText:f,loading:n,onPress:g})}var I=function(){var e={defaultValue:null,kind:"LocalArgument",name:"after"},n={defaultValue:null,kind:"LocalArgument",name:"before"},t={defaultValue:null,kind:"LocalArgument",name:"conversationUuid"},a={defaultValue:null,kind:"LocalArgument",name:"first"},r={defaultValue:null,kind:"LocalArgument",name:"guestUserUuid"},i={defaultValue:null,kind:"LocalArgument",name:"last"},o={kind:"Variable",name:"guestUserUuid",variableName:"guestUserUuid"},l=[o,{kind:"Variable",name:"uuid",variableName:"conversationUuid"}],s={alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"isClosed",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},p={alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"creator",plural:!1,selections:[d],storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"closeTime",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},m={alias:null,args:null,concreteType:"ChatSupportAttribute",kind:"LinkedField",name:"additionalMetadata",plural:!0,selections:[f,v],storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},C={alias:null,args:null,concreteType:"ErrorData",kind:"LinkedField",name:"errorData",plural:!1,selections:[b,h,{alias:null,args:null,kind:"ScalarField",name:"isFatal",storageKey:null}],storageKey:null},k={alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},d],storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},S={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},j={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},E={kind:"Variable",name:"after",variableName:"after"},T={kind:"Variable",name:"before",variableName:"before"},O={kind:"Variable",name:"conversationUuid",variableName:"conversationUuid"},w={kind:"Variable",name:"first",variableName:"first"},_={kind:"Variable",name:"last",variableName:"last"},U={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},P={alias:null,args:[O,o],concreteType:"ChatSupportConfigSettings",kind:"LinkedField",name:"chatSupportConfigSettings",plural:!1,selections:[{alias:null,args:null,concreteType:"ChatSupportAttribute",kind:"LinkedField",name:"configs",plural:!0,selections:[v,f],storageKey:null},{alias:null,args:null,concreteType:"ChatSupportPIIRegex",kind:"LinkedField",name:"piiRegexList",plural:!0,selections:[U,{alias:null,args:null,kind:"ScalarField",name:"regex",storageKey:null}],storageKey:null}],storageKey:null},I=[E,T,w,_];return{fragment:{argumentDefinitions:[e,n,t,a,r,i],kind:"Fragment",metadata:null,name:"ChatWidgetInternalUnauthenticatedQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:l,concreteType:"ConversationResult",kind:"LinkedField",name:"unauthenticatedConversationByUuid",plural:!1,selections:[s,{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"node",plural:!1,selections:[u,c,p,g,m,{alias:"events",args:null,concreteType:"ConversationEventsConnection",kind:"LinkedField",name:"__ChatBodyConversationLoggedOutThread_events_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[y,{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[d,c,b,C,k,{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[h],storageKey:null},x],storageKey:null}],storageKey:null},S,j],storageKey:null}],storageKey:null}],storageKey:null},{args:[E,T,O,w,o,_],kind:"FragmentSpread",name:"ChatBodyConversationLoggedOutThreadFragment"}],storageKey:null},P],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,r,a,e,n,i],kind:"Operation",name:"ChatWidgetInternalUnauthenticatedQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:l,concreteType:"ConversationResult",kind:"LinkedField",name:"unauthenticatedConversationByUuid",plural:!1,selections:[s,{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"node",plural:!1,selections:[u,c,p,g,m,{alias:null,args:I,concreteType:"ConversationEventsConnection",kind:"LinkedField",name:"events",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[y,{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[d,c,b,C,k,{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[h,{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[U,{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},x,{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]}],storageKey:null}],storageKey:null},S,j],storageKey:null},{alias:null,args:I,filters:null,handle:"connection",key:"ChatBodyConversationLoggedOutThread_events",kind:"LinkedHandle",name:"events"},d],storageKey:null}],storageKey:null},d],storageKey:null},P]},params:{cacheID:"2e4a1a6422d32efddc700c7b27a5c3b0",id:null,metadata:{connection:[{count:null,cursor:null,direction:"bidirectional",path:["viewer","unauthenticatedConversationByUuid","node","events"]}]},name:"ChatWidgetInternalUnauthenticatedQuery",operationKind:"query",text:"query ChatWidgetInternalUnauthenticatedQuery(\n  $conversationUuid: Uuid!\n  $guestUserUuid: Uuid!\n  $first: Int!\n  $after: String\n  $before: String\n  $last: Int\n) {\n  viewer {\n    unauthenticatedConversationByUuid(uuid: $conversationUuid, guestUserUuid: $guestUserUuid) {\n      error\n      node {\n        isClosed\n        uuid\n        creator {\n          id\n        }\n        closeTime\n        additionalMetadata {\n          value\n          key\n        }\n        events(first: $first, after: $after, before: $before, last: $last) {\n          edges {\n            cursor\n            node {\n              id\n              uuid\n              type\n              errorData {\n                type\n                message\n                isFatal\n              }\n              participant {\n                participantType\n                displayName\n                id\n              }\n              messageContent {\n                message\n              }\n              __typename\n            }\n          }\n          pageInfo {\n            endCursor\n            hasNextPage\n            hasPreviousPage\n            startCursor\n          }\n        }\n        id\n      }\n    }\n    ...ChatBodyConversationLoggedOutThreadFragment_3Kko1M\n    id\n  }\n  chatSupportConfigSettings(conversationUuid: $conversationUuid, guestUserUuid: $guestUserUuid) {\n    configs {\n      key\n      value\n    }\n    piiRegexList {\n      label\n      regex\n    }\n  }\n}\n\nfragment ChatBodyConversationLoggedOutThreadFragment_3Kko1M on Viewer {\n  unauthenticatedConversationByUuid(uuid: $conversationUuid, guestUserUuid: $guestUserUuid) {\n    node {\n      uuid\n      isClosed\n      events(first: $first, after: $after, before: $before, last: $last) {\n        edges {\n          cursor\n          node {\n            id\n            uuid\n            type\n            createTime\n            participant {\n              participantType\n              id\n            }\n            ...MessageTypeToUIRendererFragment\n            __typename\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n          hasPreviousPage\n          startCursor\n        }\n      }\n      id\n    }\n  }\n}\n\nfragment MessageBubbleFragment on ConversationEvent {\n  id\n  uuid\n  participant {\n    id\n    displayName\n    participantType\n  }\n  createTime\n  messageContent {\n    message\n    replies {\n      label\n      link\n      messageToPublish\n    }\n    extraElementType\n    extraElementPayload\n  }\n}\n\nfragment MessageTypeToUIRendererFragment on ConversationEvent {\n  type\n  ...MessageBubbleFragment\n  ...ParticipantBubbleFragment\n}\n\nfragment ParticipantBubbleFragment on ConversationEvent {\n  participant {\n    displayName\n    participantType\n    id\n  }\n}\n"}}}();I.hash="1ff70c290bea491836b7b8fa51d8eb74";var F=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"connections"},{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},o={alias:null,args:null,concreteType:"ErrorData",kind:"LinkedField",name:"errorData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isFatal",storageKey:null},r,i],storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"conversation",plural:!1,selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"isClosed",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UnauthenticatedChatEventSubscriberSubscription",selections:[{alias:"event",args:n,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"subscribeUnauthenticatedConversationEventsByConversation",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[a,o,s,{args:null,kind:"FragmentSpread",name:"MessageTypeToUIRendererFragment"}],storageKey:null}],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UnauthenticatedChatEventSubscriberSubscription",selections:[{alias:"event",args:n,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"subscribeUnauthenticatedConversationEventsByConversation",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[a,o,s,r,l,{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[i,{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]}],storageKey:null},{alias:null,args:null,filters:null,handle:"appendNode",key:"",kind:"LinkedHandle",name:"node",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"},{kind:"Literal",name:"edgeTypeName",value:"ConversationEventEdge"}]}],storageKey:null}]},params:{cacheID:"aa540b8d00a60a6cc3583c86c8167f3e",id:null,metadata:{},name:"UnauthenticatedChatEventSubscriberSubscription",operationKind:"subscription",text:"subscription UnauthenticatedChatEventSubscriberSubscription(\n  $input: SubscribeEventsByConversationInput!\n) {\n  event: subscribeUnauthenticatedConversationEventsByConversation(input: $input) {\n    cursor\n    node {\n      uuid\n      errorData {\n        isFatal\n        type\n        message\n      }\n      conversation {\n        id\n        uuid\n        isClosed\n      }\n      ...MessageTypeToUIRendererFragment\n      id\n    }\n  }\n}\n\nfragment MessageBubbleFragment on ConversationEvent {\n  id\n  uuid\n  participant {\n    id\n    displayName\n    participantType\n  }\n  createTime\n  messageContent {\n    message\n    replies {\n      label\n      link\n      messageToPublish\n    }\n    extraElementType\n    extraElementPayload\n  }\n}\n\nfragment MessageTypeToUIRendererFragment on ConversationEvent {\n  type\n  ...MessageBubbleFragment\n  ...ParticipantBubbleFragment\n}\n\nfragment ParticipantBubbleFragment on ConversationEvent {\n  participant {\n    displayName\n    participantType\n    id\n  }\n}\n"}}}();F.hash="1ffbd8f15cc6ba02d44d86671908c4d0";var M=F;function D(e){var n=e.conversationUuid,t=e.guestUserUuid,a=e.after,i=e.eventsConnectionId;return(0,e.children)((0,r.n)({query:M,conversationUuid:n,after:a,eventsConnectionId:i,guestUserUuid:t}))}function K(e){var n=e.children,t=(0,r.l)(),a=(0,r.m)();return t&&a?(0,p.jsx)(D,x({},e)):n(!1)}var L=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"connections"},{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},r={kind:"InlineFragment",selections:[a],type:"BadRequestError",abstractKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ChatBodyCreateUnauthenticatedConversationEventMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedEvent",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"conversationEvent",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MessageTypeToUIRendererFragment"}],storageKey:null}],storageKey:null}],type:"CreateUnauthenticatedEventSuccess",abstractKey:null},r],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ChatBodyCreateUnauthenticatedConversationEventMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedEvent",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"conversationEvent",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[a,{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]}],storageKey:null},{alias:null,args:null,filters:null,handle:"appendNode",key:"",kind:"LinkedHandle",name:"node",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"},{kind:"Literal",name:"edgeTypeName",value:"ConversationEventEdge"}]}],storageKey:null}],type:"CreateUnauthenticatedEventSuccess",abstractKey:null},r],storageKey:null}]},params:{cacheID:"dba1e3b70c50cfebbc922a6585e2c423",id:null,metadata:{},name:"ChatBodyCreateUnauthenticatedConversationEventMutation",operationKind:"mutation",text:"mutation ChatBodyCreateUnauthenticatedConversationEventMutation(\n  $input: CreateUnauthenticatedEventInput!\n) {\n  createUnauthenticatedEvent(input: $input) {\n    __typename\n    ... on CreateUnauthenticatedEventSuccess {\n      conversationEvent {\n        node {\n          ...MessageTypeToUIRendererFragment\n          id\n        }\n      }\n    }\n    ... on BadRequestError {\n      message\n    }\n  }\n}\n\nfragment MessageBubbleFragment on ConversationEvent {\n  id\n  uuid\n  participant {\n    id\n    displayName\n    participantType\n  }\n  createTime\n  messageContent {\n    message\n    replies {\n      label\n      link\n      messageToPublish\n    }\n    extraElementType\n    extraElementPayload\n  }\n}\n\nfragment MessageTypeToUIRendererFragment on ConversationEvent {\n  type\n  ...MessageBubbleFragment\n  ...ParticipantBubbleFragment\n}\n\nfragment ParticipantBubbleFragment on ConversationEvent {\n  participant {\n    displayName\n    participantType\n    id\n  }\n}\n"}}}();L.hash="8e6845e89f4cf88c070d9c9d13a4f667";var B=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"before"},{defaultValue:null,kind:"LocalArgument",name:"conversationUuid"},{defaultValue:null,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"guestUserUuid"},{defaultValue:null,kind:"LocalArgument",name:"last"}],n={kind:"Variable",name:"after",variableName:"after"},t={kind:"Variable",name:"before",variableName:"before"},a={kind:"Variable",name:"first",variableName:"first"},r={kind:"Variable",name:"guestUserUuid",variableName:"guestUserUuid"},i={kind:"Variable",name:"last",variableName:"last"},o={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},l=[n,t,a,i],s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ChatBodyConversationLoggedOutThreadFragmentQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:[n,t,{kind:"Variable",name:"conversationUuid",variableName:"conversationUuid"},a,r,i],kind:"FragmentSpread",name:"ChatBodyConversationLoggedOutThreadFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ChatBodyConversationLoggedOutThreadFragmentQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[r,{kind:"Variable",name:"uuid",variableName:"conversationUuid"}],concreteType:"ConversationResult",kind:"LinkedField",name:"unauthenticatedConversationByUuid",plural:!1,selections:[{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"node",plural:!1,selections:[o,{alias:null,args:null,kind:"ScalarField",name:"isClosed",storageKey:null},{alias:null,args:l,concreteType:"ConversationEventsConnection",kind:"LinkedField",name:"events",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[s,o,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ChatBodyConversationLoggedOutThread_events",kind:"LinkedHandle",name:"events"},s],storageKey:null}],storageKey:null},s],storageKey:null}]},params:{cacheID:"398872b8a7ec51dcfc5f5b82f7303f55",id:null,metadata:{},name:"ChatBodyConversationLoggedOutThreadFragmentQuery",operationKind:"query",text:"query ChatBodyConversationLoggedOutThreadFragmentQuery(\n  $after: String\n  $before: String\n  $conversationUuid: Uuid!\n  $first: Int\n  $guestUserUuid: Uuid!\n  $last: Int\n) {\n  viewer {\n    ...ChatBodyConversationLoggedOutThreadFragment_3Kko1M\n    id\n  }\n}\n\nfragment ChatBodyConversationLoggedOutThreadFragment_3Kko1M on Viewer {\n  unauthenticatedConversationByUuid(uuid: $conversationUuid, guestUserUuid: $guestUserUuid) {\n    node {\n      uuid\n      isClosed\n      events(first: $first, after: $after, before: $before, last: $last) {\n        edges {\n          cursor\n          node {\n            id\n            uuid\n            type\n            createTime\n            participant {\n              participantType\n              id\n            }\n            ...MessageTypeToUIRendererFragment\n            __typename\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n          hasPreviousPage\n          startCursor\n        }\n      }\n      id\n    }\n  }\n}\n\nfragment MessageBubbleFragment on ConversationEvent {\n  id\n  uuid\n  participant {\n    id\n    displayName\n    participantType\n  }\n  createTime\n  messageContent {\n    message\n    replies {\n      label\n      link\n      messageToPublish\n    }\n    extraElementType\n    extraElementPayload\n  }\n}\n\nfragment MessageTypeToUIRendererFragment on ConversationEvent {\n  type\n  ...MessageBubbleFragment\n  ...ParticipantBubbleFragment\n}\n\nfragment ParticipantBubbleFragment on ConversationEvent {\n  participant {\n    displayName\n    participantType\n    id\n  }\n}\n"}}}();B.hash="9013121efd9042c9d440421e8cf477b8";var A=function(){var e=["unauthenticatedConversationByUuid","node","events"],n={alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"before"},{defaultValue:null,kind:"LocalArgument",name:"conversationUuid"},{defaultValue:null,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"guestUserUuid"},{defaultValue:null,kind:"LocalArgument",name:"last"}],kind:"Fragment",metadata:{connection:[{count:null,cursor:null,direction:"bidirectional",path:e}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:{count:"last",cursor:"before"},path:e},fragmentPathInResult:["viewer"],operation:B}},name:"ChatBodyConversationLoggedOutThreadFragment",selections:[{alias:null,args:[{kind:"Variable",name:"guestUserUuid",variableName:"guestUserUuid"},{kind:"Variable",name:"uuid",variableName:"conversationUuid"}],concreteType:"ConversationResult",kind:"LinkedField",name:"unauthenticatedConversationByUuid",plural:!1,selections:[{alias:null,args:null,concreteType:"Conversation",kind:"LinkedField",name:"node",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"isClosed",storageKey:null},{alias:"events",args:null,concreteType:"ConversationEventsConnection",kind:"LinkedField",name:"__ChatBodyConversationLoggedOutThread_events_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"MessageTypeToUIRendererFragment"},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Viewer",abstractKey:null}}();A.hash="9013121efd9042c9d440421e8cf477b8";var N=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"connections"},{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},r={kind:"InlineFragment",selections:[a],type:"BadRequestError",abstractKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserInputCreateUnauthenticatedConversationEventMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedEvent",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"conversationEvent",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MessageTypeToUIRendererFragment"}],storageKey:null}],storageKey:null}],type:"CreateUnauthenticatedEventSuccess",abstractKey:null},r],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserInputCreateUnauthenticatedConversationEventMutation",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"createUnauthenticatedEvent",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"conversationEvent",plural:!1,selections:[{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},{alias:null,args:null,concreteType:"Participant",kind:"LinkedField",name:"participant",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"participantType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createTime",storageKey:null},{alias:null,args:null,concreteType:"MessageContent",kind:"LinkedField",name:"messageContent",plural:!1,selections:[a,{alias:null,args:null,concreteType:"QuickReply",kind:"LinkedField",name:"replies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageToPublish",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extraElementPayload",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"hasUploadFailed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBeingUploaded",storageKey:null}]}],storageKey:null},{alias:null,args:null,filters:null,handle:"appendNode",key:"",kind:"LinkedHandle",name:"node",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"},{kind:"Literal",name:"edgeTypeName",value:"ConversationEventEdge"}]}],storageKey:null}],type:"CreateUnauthenticatedEventSuccess",abstractKey:null},r],storageKey:null}]},params:{cacheID:"4532a6848134e6b5c6429075881fed1d",id:null,metadata:{},name:"UserInputCreateUnauthenticatedConversationEventMutation",operationKind:"mutation",text:"mutation UserInputCreateUnauthenticatedConversationEventMutation(\n  $input: CreateUnauthenticatedEventInput!\n) {\n  createUnauthenticatedEvent(input: $input) {\n    __typename\n    ... on CreateUnauthenticatedEventSuccess {\n      conversationEvent {\n        node {\n          ...MessageTypeToUIRendererFragment\n          id\n        }\n      }\n    }\n    ... on BadRequestError {\n      message\n    }\n  }\n}\n\nfragment MessageBubbleFragment on ConversationEvent {\n  id\n  uuid\n  participant {\n    id\n    displayName\n    participantType\n  }\n  createTime\n  messageContent {\n    message\n    replies {\n      label\n      link\n      messageToPublish\n    }\n    extraElementType\n    extraElementPayload\n  }\n}\n\nfragment MessageTypeToUIRendererFragment on ConversationEvent {\n  type\n  ...MessageBubbleFragment\n  ...ParticipantBubbleFragment\n}\n\nfragment ParticipantBubbleFragment on ConversationEvent {\n  participant {\n    displayName\n    participantType\n    id\n  }\n}\n"}}}();N.hash="034d4dd8c58b0b54f6488777c77e5072";var R="local-id";function V(e,n,t,a){return a({variables:{connections:[],input:{conversationUuid:e,guestUserUuid:n,type:t}},onError:function(n){var t=n.alreadyReportedError;(0,r.g)().logError(t,{context:"send_started_typing_event",severity:"error",isHandled:!1,conversationUuid:e})},onCompleted:function(){}})}function H(e,n){return e.get(null!==n&&void 0!==n?n:"")}function W(e,n){var t,a=H(e,n);a&&(null===(t=a.getLinkedRecords("edges"))||void 0===t||t.filter((function(e){var n,t;return null===(n=e.getLinkedRecord("node"))||void 0===n||null===(t=n.getValue("uuid"))||void 0===t?void 0:t.toString().startsWith(R)})).forEach((function(e){var n,t;return s.qB.deleteNode(a,null!==(n=null===e||void 0===e||null===(t=e.getLinkedRecord("node"))||void 0===t?void 0:t.getDataID())&&void 0!==n?n:"")})))}async function z(e,n,t,a,r,i,o){return new Promise((function(l,u){(0,s.uL)(r,(function(e){W(e,a)})),i({variables:{connections:a?[a]:[],input:{conversationUuid:e,guestUserUuid:n,type:"MESSAGE_CONTENT",message:t,inReplyToUuid:o}},optimisticResponse:{createUnauthenticatedEvent:{__typename:"CreateUnauthenticatedEventSuccess",conversationEvent:{node:{id:"local-event-id",uuid:"local-uuid",type:"MESSAGE_CONTENT",isBeingUploaded:!0,hasUploadFailed:!1,messageContent:{message:t,replies:[],extraElementPayload:null,extraElementType:null},participant:{id:"local-participant-id",displayName:"",participantType:"USER"},createTime:(new Date).toISOString()}}}},onError:function(e){var n=e.alreadyReportedError;(0,s.uL)(r,(function(e){!function(e,n,t){var a=H(e,t);if(a){var r=e.create("".concat(R,":").concat(Date.now()),"ConversationEvent");r.setValue("".concat(R,":id"),"id"),r.setValue("".concat(R,":uuid"),"uuid"),r.setValue((new Date).toString(),"createTime"),r.setValue("MESSAGE_CONTENT","type"),r.setValue(!0,"hasUploadFailed"),r.getOrCreateLinkedRecord("messageContent","MessageContent").setValue(n,"message"),r.getOrCreateLinkedRecord("participant","Participant").setValue("USER","participantType"),s.qB.insertEdgeAfter(a,s.qB.createEdge(e,a,r,"ConversationEventEdge"))}}(e,t,a)})),u(n)},onCompleted:function(e){var n=e.response;l(n)},updater:function(e,n){var t;"CreateUnauthenticatedEventSuccess"===(null===(t=n.createUnauthenticatedEvent)||void 0===t?void 0:t.__typename)&&W(e,a)}})}))}var $=N;function G(e,n){(0,r.b)("cb_chat_send_message",n,{status:e?"success":"failure",unauth:!0})}var q=(0,a.memo)((function(e){var n=e.eventsConnectionId,t=e.piiRegexList,i=e.onChange,l=(0,r.u)(),u=l.conversationUuid,c=l.guestUserUuid,g=(0,s.ld)(),f=j((0,a.useState)((0,r.a)("LOCAL_STORAGE_CHAT_INPUT_KEY","")),2),v=f[0],m=f[1],y=j((0,a.useState)(!1),2),b=y[0],h=y[1],C=j((0,s.Db)($),1)[0],k=(0,o.NO)(),x=(0,a.useCallback)((function(e){var n,t,a,o;c?(0===(null!==(n=null===v||void 0===v?void 0:v.length)&&void 0!==n?n:0)&&(null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0?V(u,c,"STARTED_TYPING",C):(null!==(a=null===v||void 0===v?void 0:v.length)&&void 0!==a?a:0)>0&&0===(null!==(o=null===e||void 0===e?void 0:e.length)&&void 0!==o?o:0)&&V(u,c,"STOPPED_TYPING",C),m(null!==e&&void 0!==e?e:""),(0,r.s)("LOCAL_STORAGE_CHAT_INPUT_KEY",null!==e&&void 0!==e?e:""),null===i||void 0===i||i(null!==e&&void 0!==e?e:"")):k.logError(new Error("Guest User UUID is empty"),{context:"user_input",severity:"error",isHandled:!0})}),[u,C,c,null===v||void 0===v?void 0:v.length,i,k]),S=(0,a.useCallback)((function(){c?((0,d.ZD)("cb_chat_message_overall_latency","user-input","existing",{unauth:!0}),h(!0),z(u,c,(0,d.Mm)({message:v.trim(),regexes:null!==t&&void 0!==t?t:[]}),n,g,C).then((function(e){var n;(0,d.ZD)("cb_chat_message_latency","user-input","existing",{unauth:!0}),"CreateUnauthenticatedEventSuccess"===(null===(n=e.createUnauthenticatedEvent)||void 0===n?void 0:n.__typename)&&(m(""),(0,r.r)("LOCAL_STORAGE_CHAT_INPUT_KEY"),G(!0,u))})).catch((function(e){(0,d.CV)("cb_chat_message_overall_latency"),k.logError(e,{context:"user_input",severity:"error",isHandled:!0,conversationUuid:u}),G(!1,u)})).finally((function(){h(!1)}))):k.logError(new Error("Guest User UUID is empty"),{context:"user_input",severity:"error",isHandled:!0})}),[u,C,n,c,v,t,g,k]);return(0,p.jsx)(r.B,{inputText:null!==v&&void 0!==v?v:"",loading:b,onChangeText:x,onSendMessage:S})})),Q=(0,u.vU)({loadingConversationsMessage:{id:"ChatSupport.ChatBody.loadingConversationsMessage",defaultMessage:"Loading older messages",description:"Loading message to show adjacent to spinner when loading older messages scrolling up in chat"}}),Z=["MESSAGE_CONTENT"],J=A;function Y(e,n){var t;return e.id===(null===(t=C(n).reverse().find((function(e){var n,t;return!(0,d.Qj)(null!==(n=null===(t=e.participant)||void 0===t?void 0:t.participantType)&&void 0!==n?n:"")&&"MESSAGE_CONTENT"===e.type})))||void 0===t?void 0:t.id)}function X(e,n){var t,a,r,i,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return o&&Y(e,n)&&((0,d.ej)(null!==(t=null===(a=e.participant)||void 0===a?void 0:a.participantType)&&void 0!==t?t:"")||(0,d.$1)(null!==(r=null===(i=e.participant)||void 0===i?void 0:i.participantType)&&void 0!==r?r:""))}function ee(e,n){(0,r.b)("cb_chat_send_message",n,{status:e?"success":"failure",unauth:!0})}var ne=L,te=(0,a.memo)((function(e){var n,t,i,l,u,m,y,b,h,C,k,x,S,E,T=e.viewer,O=e.piiRegexList,w=j((0,a.useState)(null),2),_=w[0],U=w[1],P=j((0,a.useState)(0),2),I=P[0],F=P[1],M=(0,c.Z)().formatMessage,D=(0,r.c)(),K=D.latestEvent,L=D.updateLatestEvent,B=(0,s.nu)(J,T),A=B.data,N=B.loadPrevious,R=B.isLoadingPrevious,V=B.hasPrevious,H=null===(n=A.unauthenticatedConversationByUuid)||void 0===n||null===(t=n.node)||void 0===t?void 0:t.uuid,W=null===(i=A.unauthenticatedConversationByUuid)||void 0===i||null===(l=i.node)||void 0===l||null===(u=l.events)||void 0===u?void 0:u.__id,$=(0,s.ld)(),G=(0,r.u)().guestUserUuid,Y=j((0,s.Db)(ne),1)[0],te=null!==(m=!(null===(y=A.unauthenticatedConversationByUuid)||void 0===y||null===(b=y.node)||void 0===b||!b.isClosed)||(null===(h=A.unauthenticatedConversationByUuid)||void 0===h||null===(C=h.node)||void 0===C||null===(k=C.events)||void 0===k?void 0:k.edges.some((function(e){var n;return"CONVERSATION_CLOSED"===(null===(n=e.node)||void 0===n?void 0:n.type)}))))&&void 0!==m&&m,ae=null===(x=A.unauthenticatedConversationByUuid)||void 0===x||null===(S=x.node)||void 0===S||null===(E=S.events)||void 0===E?void 0:E.edges,re=(0,a.useMemo)((function(){return(null!==ae&&void 0!==ae?ae:[]).map((function(e){return e.node})).filter((function(e){return null!==e&&(Z.includes(e.type)||function(e){var n,t;return"PARTICIPANT_JOINED"===(null===e||void 0===e?void 0:e.type)&&(0,d.$1)(null!==(n=null===(t=e.participant)||void 0===t?void 0:t.participantType)&&void 0!==n?n:"")}(e))}))}),[ae]);(0,a.useEffect)((function(){var e;re.length>=1&&((0,d.b7)("cb_chat_starting_latency",H,{particpantType:null===(e=re[re.length-1].participant)||void 0===e?void 0:e.participantType,unauth:!0}),(0,d.b7)("cb_chat_start_latency_loader",H,{unauth:!0}))}),[H,re]);var ie=function(e){var n,t,a,r,i=e.length,o=e[i-1],l=e[i-2];if((null===o||void 0===o||null===(n=o.participant)||void 0===n?void 0:n.participantType)!==(null===l||void 0===l||null===(t=l.participant)||void 0===t?void 0:t.participantType)||(0,d.Io)(null!==(a=null===o||void 0===o||null===(r=o.participant)||void 0===r?void 0:r.participantType)&&void 0!==a?a:""))return null!==o&&void 0!==o&&o.id?"event-".concat(o.id):void 0}(re),oe=(0,a.useMemo)((function(){return(null!==ae&&void 0!==ae?ae:[]).filter((function(e){var n,t,a,r;return null!==e.node&&"MESSAGE_CONTENT"===(null===(n=e.node)||void 0===n?void 0:n.type)&&!(0,d.Io)(null!==(t=null===(a=e.node)||void 0===a||null===(r=a.participant)||void 0===r?void 0:r.participantType)&&void 0!==t?t:"")}))}),[ae]),le=(0,a.useMemo)((function(){var e=null!==K&&void 0!==K&&K.uuid?oe.findIndex((function(e){var n;return K.uuid===(null===(n=e.node)||void 0===n?void 0:n.uuid)})):-1;return e<0||e===oe.length-1?0:oe.length-(e+1)}),[null===K||void 0===K?void 0:K.uuid,oe]),se=(0,a.useCallback)((function(){return!(R||!V)&&(N(r.P),!0)}),[N,R,V]),ue=(0,a.useCallback)((function(){var e,n=(0,r.d)(oe);null!==n&&void 0!==n&&n.node&&(null===(e=n.node)||void 0===e?void 0:e.uuid)!==(null===K||void 0===K?void 0:K.uuid)&&L({uuid:n.node.uuid,cursor:n.cursor,createTime:n.node.createTime})}),[null===K||void 0===K?void 0:K.uuid,oe,L]),ce=(0,a.useCallback)((function(){var e;F(null!==(e=null===_||void 0===_?void 0:_.offsetHeight)&&void 0!==e?e:0)}),[null===_||void 0===_?void 0:_.offsetHeight]);(0,a.useEffect)((function(){ce()}),[ce]);var de=(0,o.NO)(),pe=(0,a.useCallback)((function(e,n){G?((0,d.ZD)("cb_chat_message_overall_latency","quick-reply","existing",{unauth:!0}),z(H,G,(0,d.Mm)({message:e,regexes:null!==O&&void 0!==O?O:[]}),W,$,Y,n).then((function(){(0,d.ZD)("cb_chat_message_latency","message-bubble-data-wrapper","existing",{unauth:!0}),ee(!0,H)})).catch((function(e){(0,d.CV)("cb_chat_message_overall_latency"),ee(!1,H),de.logError(e,{context:"chat_body",severity:"error",isHandled:!0,conversationUuid:H})}))):de.logError(new Error("Guest User UUID is empty"),{context:"chat_body",severity:"error",isHandled:!0})}),[H,G,O,W,$,Y,de]),ge=(0,a.useCallback)((function(){(0,r.e)("cbchat_scroll_to_bottom",H,{unauth:!0})}),[H]);return 0===re.length?(0,p.jsx)(r.f,{}):(0,p.jsx)(r.h,{bottomPadding:I,unreadMessageCount:le,shouldRestoreScroll:!R,autoScrollKey:ie,onTopReached:se,onBottomReached:ue,onScrollToEndPress:ge,children:(0,p.jsxs)(p.Fragment,{children:[R&&(0,p.jsxs)(g.HStack,{justifyContent:"center",alignItems:"center",height:10,spacingVertical:2,children:[(0,p.jsx)(f.$,{size:2}),(0,p.jsx)(v.TextLabel2,{testID:"loading-message",as:"span",color:"foregroundMuted",spacingHorizontal:1,spacingVertical:1,align:"center",children:M(Q.loadingConversationsMessage)})]}),re.map((function(e){return(0,r.i)(H,e,{unauth:!0}),(0,p.jsx)(r.M,{event:e,conversationId:H,onReplyPress:pe,showQuickReplies:X(e,re,!(null!==te&&void 0!==te&&te))},e.id)})),te?null:(0,p.jsx)(g.VStack,{pin:"bottom",width:"100%",ref:U,children:(0,p.jsx)(q,{onChange:ce,eventsConnectionId:W,piiRegexList:O})},"input-wrapper")]})})})),ae=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"createUnauthenticatedEvent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ConversationEventEdge",kind:"LinkedField",name:"conversationEvent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ConversationEvent",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uuid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],type:"CreateUnauthenticatedEventSuccess",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"code",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"BadRequestError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ChatHeaderUnauthSoftCloseMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ChatHeaderUnauthSoftCloseMutation",selections:n},params:{cacheID:"668ad089ddfb7b508a5073d8e5c252e1",id:null,metadata:{},name:"ChatHeaderUnauthSoftCloseMutation",operationKind:"mutation",text:"mutation ChatHeaderUnauthSoftCloseMutation(\n  $input: CreateUnauthenticatedEventInput!\n) {\n  createUnauthenticatedEvent(input: $input) {\n    __typename\n    ... on CreateUnauthenticatedEventSuccess {\n      conversationEvent {\n        cursor\n        node {\n          id\n          uuid\n          type\n        }\n      }\n    }\n    ... on BadRequestError {\n      __typename\n      code\n      message\n    }\n  }\n}\n"}}}();ae.hash="851378b40a9368227bd1fc13ef890dc2";var re=ae,ie=(0,a.memo)((function(e){var n=e.agentParticipant,t=e.isAgentActive,i=e.config,l=e.conversationUuid,u=e.isConversationClosed,c=void 0!==u&&u,g=e.isTyping,f=e.guestUserUuid,v=j((0,s.Db)(re),2),m=v[0],y=v[1],b=(0,o.NO)(),h=(0,a.useCallback)((function(){(0,r.e)("cbchat_tray_end_conversation_soft",l,{loggedOut:!0,unauth:!0}),(0,d.ZD)("cb_chat_message_overall_latency","end-chat-button","existing",{unauth:!0}),m({variables:{input:{conversationUuid:l,guestUserUuid:f,type:"INTENT_TO_CLOSE"}},onCompleted:function(e){var n=e.response.createUnauthenticatedEvent;"CreateUnauthenticatedEventSuccess"===(null===n||void 0===n?void 0:n.__typename)&&(0,d.ZD)("cb_chat_message_latency","end-chat-button","existing",{unauth:!0})},onError:function(e){var n=e.alreadyReportedError;(0,d.CV)("cb_chat_message_overall_latency"),b.logError(n,{context:"chat_header",severity:"error",isHandled:!0,conversationUuid:l})}})}),[l,f,m,b]);return(0,p.jsx)(r.o,{conversationUuid:l,isConversationClosed:c,config:i,agentParticipant:n,isAgentActive:t,isTyping:g,isClosingConversation:y,onCloseConversation:h})})),oe=(0,u.vU)({conversationUuidLabel:{id:"DebugModeUI.conversationUuidLabel",defaultMessage:"Conversation UUID: {conversationUuid}",description:"Conversation UUID field"},guestUserUuidLabel:{id:"DebugModeUI.guestUserUuidLabel",defaultMessage:"Guest User UUID: {guestUserUuid}",description:"Guest User UUID field"}});function le(){var e=(0,c.Z)().formatMessage,n=(0,r.j)().enableDebugMode,t=void 0!==n&&n,a=(0,r.u)(),i=a.conversationUuid,o=a.guestUserUuid;return t?(0,p.jsx)(m.Box,{spacing:1,width:"100%",children:(0,p.jsxs)(y.VStack,{bordered:!0,width:"100%",spacing:1,gap:2,children:[(0,p.jsx)(b.TextLegal,{as:"p",children:e(oe.conversationUuidLabel,{conversationUuid:i})}),(0,p.jsx)(b.TextLegal,{as:"p",children:e(oe.guestUserUuidLabel,{guestUserUuid:o})})]})}):null}function se(){}function ue(e){var n,t,i,l,s,u,c,f,v,m=e.conversationUuid,y=e.guestUserUuid,b=e.queryData,h=e.isSubscriptionActive,C=e.onCreateConversation,k=e.conversationCreationStatus,x=e.layout,S=(0,r.u)().onCollapse,j=null===(n=b.viewer.unauthenticatedConversationByUuid)||void 0===n?void 0:n.node,E=(0,a.useMemo)((function(){var e,n;return(null!==(e=null===(n=b.chatSupportConfigSettings)||void 0===n?void 0:n.piiRegexList)&&void 0!==e?e:[]).filter(Boolean).map((function(e){return{label:null===e||void 0===e?void 0:e.label,regex:null===e||void 0===e?void 0:e.regex}}))}),[null===(t=b.chatSupportConfigSettings)||void 0===t?void 0:t.piiRegexList]),T=(0,r.d)(null!==(i=null===j||void 0===j||null===(l=j.events)||void 0===l?void 0:l.edges.filter((function(e){var n,t,a,r;return"PARTICIPANT_JOINED"===(null===(n=e.node)||void 0===n?void 0:n.type)&&(0,d.$1)(null!==(t=null===(a=e.node)||void 0===a||null===(r=a.participant)||void 0===r?void 0:r.participantType)&&void 0!==t?t:"")})).map((function(e){var n;return null===(n=e.node)||void 0===n?void 0:n.participant})))&&void 0!==i?i:[]),O=T&&(null===j||void 0===j||null===(s=j.events)||void 0===s?void 0:s.edges.every((function(e){var n,t,a;return"PARTICIPANT_LEFT"!==(null===(n=e.node)||void 0===n?void 0:n.type)||(null===(t=e.node)||void 0===t||null===(a=t.participant)||void 0===a?void 0:a.id)!==(null===T||void 0===T?void 0:T.id)}))),w=null!==(u=!(null===j||void 0===j||!j.isClosed)||(null===j||void 0===j||null===(c=j.events)||void 0===c?void 0:c.edges.some((function(e){var n;return"CONVERSATION_CLOSED"===(null===(n=e.node)||void 0===n?void 0:n.type)}))))&&void 0!==u&&u,_=(0,o.NO)(),U=(0,a.useCallback)((function(){_.logError(new Error("User sees Connection Trouble card"),{context:"connection_trouble_chart",severity:"error",isHandled:!0,conversationUuid:m,guestUserUuid:y,visibilityState:document.visibilityState})}),[m,y,_]),P=!w&&!h,I=function(e){var n,t,a,r=!1;return null===(n=e.viewer.unauthenticatedConversationByUuid)||void 0===n||null===(t=n.node)||void 0===t||null===(a=t.events)||void 0===a||a.edges.forEach((function(e){var n,t,a,i,o,l,s,u,c;"STARTED_TYPING"!==(null===(n=e.node)||void 0===n?void 0:n.type)||(0,d.Io)(null!==(t=null===(a=e.node)||void 0===a||null===(i=a.participant)||void 0===i?void 0:i.participantType)&&void 0!==t?t:"")?"STOPPED_TYPING"!==(null===(o=e.node)||void 0===o?void 0:o.type)&&"MESSAGE_CONTENT"!==(null===(l=e.node)||void 0===l?void 0:l.type)||(0,d.Io)(null!==(s=null===(u=e.node)||void 0===u||null===(c=u.participant)||void 0===c?void 0:c.participantType)&&void 0!==s?s:"")||(r=!1):r=!0})),r}(b),F=(0,d.$D)(null!==(f=null===(v=b.chatSupportConfigSettings)||void 0===v?void 0:v.configs)&&void 0!==f?f:null);return(0,a.useEffect)((function(){w&&(0,r.t)()}),[w]),(0,p.jsxs)(r.W,{layout:x,isConversationClosed:w,children:[(0,p.jsx)(ie,{conversationUuid:m,guestUserUuid:y,isConversationClosed:w,config:F,agentParticipant:T,isAgentActive:!!O,isTyping:I}),(0,p.jsx)(g.Divider,{}),(0,p.jsx)(le,{}),(0,p.jsx)(te,{viewer:null===b||void 0===b?void 0:b.viewer,piiRegexList:E}),P?(0,p.jsx)(r.q,{onCloseChat:null!==S&&void 0!==S?S:se,onOpen:U}):null,w&&(0,p.jsx)(r.k,{onCreateNewConversation:C,conversationCreationStatus:k})]})}function ce(e){var n,t,a,i,o,l,s,u,c=e.conversationUuid,d=e.guestUserUuid,g=e.queryData;return(0,r.j)().isDisabled?(0,p.jsx)(ue,x(x({},e),{},{isSubscriptionActive:!1})):(0,p.jsx)(K,{conversationUuid:c,guestUserUuid:d,after:null!==(n=null===(t=(0,r.d)(null===g||void 0===g||null===(a=g.viewer.unauthenticatedConversationByUuid)||void 0===a||null===(i=a.node)||void 0===i||null===(o=i.events)||void 0===o?void 0:o.edges.filter((function(e){return Boolean(e.cursor)}))))||void 0===t?void 0:t.cursor)&&void 0!==n?n:void 0,eventsConnectionId:null===(l=g.viewer.unauthenticatedConversationByUuid)||void 0===l||null===(s=l.node)||void 0===s||null===(u=s.events)||void 0===u?void 0:u.__id,children:function(n){return(0,p.jsx)(ue,x(x({},e),{},{isSubscriptionActive:n}))}})}function de(e){var n,t,a,r,i,o,l,s=e.conversationUuid,u=e.guestUserUuid,c=e.queryData,d=null===(n=Boolean(s)&&Boolean(u)&&!(null!==(t=c.viewer.unauthenticatedConversationByUuid)&&void 0!==t&&null!==(a=t.node)&&void 0!==a&&a.isClosed)&&(null===(r=c.viewer.unauthenticatedConversationByUuid)||void 0===r||null===(i=r.node)||void 0===i||null===(o=i.events)||void 0===o||null===(l=o.edges)||void 0===l?void 0:l.every((function(e){var n,t,a,r=e.node;return"CONVERSATION_CLOSED"!==(null===r||void 0===r?void 0:r.type)&&!(null!==r&&void 0!==r&&null!==(n=r.errorData)&&void 0!==n&&n.isFatal)&&!("ERROR"===(null===r||void 0===r?void 0:r.type)&&"SubscriptionError"===(null===(t=r.errorData)||void 0===t?void 0:t.type)&&"Conversation Closed"===(null===(a=r.errorData)||void 0===a?void 0:a.message))}))))||void 0===n||n;return d?(0,p.jsx)(ce,x({},e)):(0,p.jsx)(ue,x({},e))}function pe(e){var n,t,i,o,s,u,c,g,f,v=e.queryData,m=(0,r.x)().toggleChatOpen,y=(0,r.c)().latestEvent,b=null===v||void 0===v||null===(n=v.viewer.unauthenticatedConversationByUuid)||void 0===n?void 0:n.node,h=(0,a.useMemo)((function(){var e,n;return null!==(e=null===b||void 0===b||null===(n=b.events)||void 0===n?void 0:n.edges.filter((function(e){var n,t,a=e.node;return"MESSAGE_CONTENT"===(null===a||void 0===a?void 0:a.type)&&!(0,d.Io)(null!==(n=null===a||void 0===a||null===(t=a.participant)||void 0===t?void 0:t.participantType)&&void 0!==n?n:"")})))&&void 0!==e?e:[]}),[b]),C=(0,a.useMemo)((function(){var e=null!==y&&void 0!==y&&y.uuid?h.findIndex((function(e){var n;return y.uuid===(null===e||void 0===e||null===(n=e.node)||void 0===n?void 0:n.uuid)})):-1;return e<0||e===h.length-1?0:h.length-(e+1)}),[null===y||void 0===y?void 0:y.uuid,h]),k=(0,a.useCallback)((function(){m(),(0,r.e)("cb_chat_entry_press",null===b||void 0===b?void 0:b.uuid,{type:"existing",unauth:!0}),(0,d.ZD)("cb_chat_start_latency_loader","new-chat-start-button","existing",{unauth:!0}),(0,d.ZD)("cb_chat_starting_latency","new-chat-start-button","existing",{unauth:!0})}),[null===b||void 0===b?void 0:b.uuid,m]);return(0,a.useEffect)((function(){var e;(0,r.y)("cb_chat_entry_impression",{componentType:l.re.button,action:l.Us.view,conversation_id:null!==(e=null===b||void 0===b?void 0:b.uuid)&&void 0!==e?e:"",chat_status:"existing",unauth:!0})}),[null===b||void 0===b?void 0:b.uuid]),(0,p.jsx)(r.z,{lastReceivedMessageParticipantType:null!==(t=null===(i=(0,r.d)(h))||void 0===i||null===(o=i.node)||void 0===o||null===(s=o.participant)||void 0===s?void 0:s.participantType)&&void 0!==t?t:"",unreadMessageCount:C,messagePromptText:C>0&&null!==(u=null===(c=(0,r.d)(h))||void 0===c||null===(g=c.node)||void 0===g||null===(f=g.messageContent)||void 0===f?void 0:f.message)&&void 0!==u?u:void 0,onPress:k})}function ge(e){var n,t,a,i,o,l,s,u=e.conversationUuid,c=e.guestUserUuid,d=e.queryData,g=null===d||void 0===d||null===(n=d.viewer.unauthenticatedConversationByUuid)||void 0===n?void 0:n.node,f=function(e,n,t){var a,r;return!!(e&&n&&t)&&!t.isClosed&&(null===(a=t.events)||void 0===a||null===(r=a.edges)||void 0===r?void 0:r.every((function(e){var n,t,a,r=e.node;return!(null!==r&&void 0!==r&&null!==(n=r.errorData)&&void 0!==n&&n.isFatal)&&!("ERROR"===(null===r||void 0===r?void 0:r.type)&&"SubscriptionError"===(null===(t=r.errorData)||void 0===t?void 0:t.type)&&"Conversation Closed"===(null===(a=r.errorData)||void 0===a?void 0:a.message))})))}(u,c,g);return f?(0,p.jsx)(K,{conversationUuid:u,guestUserUuid:c,after:null!==(t=null===(a=(0,r.d)(null===d||void 0===d||null===(i=d.viewer.unauthenticatedConversationByUuid)||void 0===i||null===(o=i.node)||void 0===o||null===(l=o.events)||void 0===l?void 0:l.edges.filter((function(e){return Boolean(e.cursor)}))))||void 0===a?void 0:a.cursor)&&void 0!==t?t:void 0,eventsConnectionId:null===g||void 0===g||null===(s=g.events)||void 0===s?void 0:s.__id,children:function(){return(0,p.jsx)(pe,{queryData:d})}}):(0,p.jsx)(pe,{queryData:d})}var fe=I;function ve(e){var n,t,i,o,l,u=e.conversationUuid,c=e.guestUserUuid,d=e.conversationCreationStatus,g=e.onCreateNewConversation,f=(0,r.x)(),v=f.isChatOpen,m=f.toggleChatOpen,y=(0,r.p)().queryFetchKey,b=(0,r.j)(),h=b.visible,C=void 0===h||h,k=b.isDisabled,x=void 0!==k&&k,S=b.layout,j=y>0?{fetchKey:y,fetchPolicy:"store-and-network"}:void 0,E=(0,s.pp)(fe,{conversationUuid:u,guestUserUuid:c,first:r.P},j),T=(0,a.useCallback)((function(){m(),(0,r.e)("cb_chat_collapse_icon",u,{status:v?"open":"close",unauth:!0})}),[v,u,m]);return C?x&&!v?(0,p.jsx)(r.F,{}):u!==(null===(n=E.viewer.unauthenticatedConversationByUuid)||void 0===n||null===(t=n.node)||void 0===t?void 0:t.uuid)||!c||null!==(i=E.viewer.unauthenticatedConversationByUuid)&&void 0!==i&&i.error?(0,p.jsx)(r.G,{conversationUuid:u,guestUserUuid:c,errorMessage:null!==(o=null===(l=E.viewer.unauthenticatedConversationByUuid)||void 0===l?void 0:l.error)&&void 0!==o?o:void 0,isStartNewChatLoading:"LOADING"===d,onStartNewChatPress:g}):v?(0,p.jsx)(r.H,{conversationUuid:u,guestUserUuid:c,onCollapse:T,children:(0,p.jsx)(de,{conversationUuid:u,guestUserUuid:c,queryData:E,onCreateConversation:g,conversationCreationStatus:d,layout:S})}):(0,p.jsx)(ge,{conversationUuid:u,guestUserUuid:c,queryData:E}):null}function me(){var e=(0,r.j)(),n=e.visible,t=void 0===n||n,i=e.layout,o=(0,r.x)(),s=o.isChatOpen,u=o.toggleChatOpen,c=(0,a.useCallback)((function(){u(),(0,r.b)("cb_chat_collapse_icon",null,{status:s?"open":"close",action:l.Us.click,componentType:l.re.button,unauth:!0})}),[s,u]);return s?(0,p.jsx)(r.I,{onCollapse:c,layout:i}):t?(0,p.jsx)(r.z,{loading:!0}):null}function ye(){var e=j((0,a.useState)(""),2),n=e[0],t=e[1],i=j((0,a.useState)(""),2),l=i[0],u=i[1],c=j((0,a.useState)(!0),2),d=c[0],g=c[1],f=j((0,a.useState)("NONE"),2),v=f[0],m=f[1],y=(0,r.x)(),b=y.isChatOpen,h=y.toggleChatOpen,C=(0,r.j)().createConversationParams,k=function(){var e=j((0,s.Db)(w),2),n=e[0],t=e[1],r=(0,o.NO)();return[(0,a.useCallback)((async function(e,t){return new Promise((function(a,i){n({variables:{input:{metadata:e?JSON.stringify(e):void 0}},onError:function(e){var n=e.alreadyReportedError;i(n),_(!1,null)},onCompleted:function(e){var n,t,o,l,s,u,c=e.response;switch(null===(n=c.createUnauthenticatedConversation)||void 0===n?void 0:n.__typename){case"CreateUnauthenticatedConversationSuccess":var d,p,g,f,v,m,y,b;null!==(t=c.createUnauthenticatedConversation)&&void 0!==t&&null!==(o=t.conversation)&&void 0!==o&&o.uuid?(_(!0,null===(d=c.createUnauthenticatedConversation)||void 0===d||null===(p=d.conversation)||void 0===p?void 0:p.uuid),a(c)):(_(!1,null),r.logError(new Error("Mutation succeeded, but unknown error while creating unauth conversation"),{context:"create_unauthenticated_conversation",severity:"error",conversationUuid:null===c||void 0===c||null===(g=c.createUnauthenticatedConversation)||void 0===g||null===(f=g.conversation)||void 0===f?void 0:f.uuid,guestUserUuid:null===(v=c.createUnauthenticatedConversation.conversation)||void 0===v||null===(m=v.creator)||void 0===m?void 0:m.uuid,isHandled:!0}),i(new Error("Received invalid conversation ID: ".concat(null===(y=c.createUnauthenticatedConversation)||void 0===y||null===(b=y.conversation)||void 0===b?void 0:b.uuid))));break;case"BadRequestError":case"Error":r.logError(new Error(null===(l=c.createUnauthenticatedConversation)||void 0===l?void 0:l.message),{context:"useCreateUnauthenticatedConversation",severity:"error",errorCode:null===c||void 0===c||null===(s=c.createUnauthenticatedConversation)||void 0===s?void 0:s.code,isHandled:!0}),i(new Error(c.createUnauthenticatedConversation.code));break;default:i(new Error("Unknown response type: ".concat(null===(u=c.createUnauthenticatedConversation)||void 0===u?void 0:u.__typename)))}},updater:function(e){var n;t&&(null===(n=e.get(t))||void 0===n||n.invalidateRecord())}})}))}),[n,r]),t]}(),S=j(k,1)[0],E=(0,o.NO)();(0,a.useEffect)((function(){!async function(){try{var e=j(await async function(){return Promise.all([r.J.get("UNAUTHENTICATED_CONVERSATION_UUID"),r.J.get("UNAUTHENTICATED_GUEST_USER_UUID")])}(),2),n=e[0],a=e[1];n&&a&&(t(n),u(a))}catch(i){i instanceof Error&&E.logError(i,{context:"chat_widget",severity:"error",isHandled:!0})}finally{g(!1)}}()}),[E]);var T,O=(0,a.useCallback)((function(){m("LOADING"),S(C).then((function(e){var n,a;if("CreateUnauthenticatedConversationSuccess"===(null===(n=e.createUnauthenticatedConversation)||void 0===n?void 0:n.__typename)&&null!==(a=e.createUnauthenticatedConversation.conversation)&&void 0!==a&&a.creator){var i=e.createUnauthenticatedConversation.conversation,o=i.creator,l=i.uuid;r.J.set("UNAUTHENTICATED_CONVERSATION_UUID",l),r.J.set("UNAUTHENTICATED_GUEST_USER_UUID",o.uuid),t(l),u(o.uuid),m("NONE"),b||h()}})).catch((function(e){E.logError(e,{context:"chat_widget",severity:"error",isHandled:!0}),m("FAILED")}))}),[C,S,b,h,E]),U=(0,a.useMemo)((function(){return x(x({},r.E),{},{conversationUuid:n,guestUserUuid:l,unauth:!0})}),[n,l]);return T=d?(0,p.jsx)(me,{}):n&&l?(0,p.jsx)(o.SV,{name:"logged-out",defaultMetadata:U,fallback:(0,p.jsx)(r.G,{conversationUuid:n,guestUserUuid:l,isStartNewChatLoading:"LOADING"===v,onStartNewChatPress:O}),children:(0,p.jsx)(ve,{conversationUuid:n,guestUserUuid:l,conversationCreationStatus:v,onCreateNewConversation:O})},n):(0,p.jsx)(P,{loading:"LOADING"===v,error:"FAILED"===v,onPress:O}),(0,p.jsx)(a.Suspense,{fallback:(0,p.jsx)(me,{}),children:T})}t(33389),t(92259),t(82899),t(63296);function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}var he=["mode"];function Ce(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ke(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ce(Object(t),!0).forEach((function(n){xe(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ce(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function xe(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==be(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==be(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===be(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Se(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var je=(0,a.memo)((function(e){var n=e.mode,t=Se(e,he);return(0,p.jsx)(r.C,ke(ke({},t),{},{mode:n,children:"LOGGED_IN"===n?(0,p.jsx)(i.C,{}):(0,p.jsx)(ye,{})}))}))},63296:function(e,n,t){t.d(n,{X3:function(){return v}});let a,r;const i=new WeakMap,o=new WeakMap,l=new WeakMap,s=new WeakMap,u=new WeakMap;let c={get(e,n,t){if(e instanceof IDBTransaction){if("done"===n)return o.get(e);if("objectStoreNames"===n)return e.objectStoreNames||l.get(e);if("store"===n)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return g(e[n])},set:(e,n,t)=>(e[n]=t,!0),has:(e,n)=>e instanceof IDBTransaction&&("done"===n||"store"===n)||n in e};function d(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...n){return e.apply(f(this),n),g(i.get(this))}:function(...n){return g(e.apply(f(this),n))}:function(n,...t){const a=e.call(f(this),n,...t);return l.set(a,n.sort?n.sort():[n]),g(a)}}function p(e){return"function"===typeof e?d(e):(e instanceof IDBTransaction&&function(e){if(o.has(e))return;const n=new Promise(((n,t)=>{const a=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=()=>{n(),a()},i=()=>{t(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)}));o.set(e,n)}(e),n=e,(a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,c):e);var n}function g(e){if(e instanceof IDBRequest)return function(e){const n=new Promise(((n,t)=>{const a=()=>{e.removeEventListener("success",r),e.removeEventListener("error",i)},r=()=>{n(g(e.result)),a()},i=()=>{t(e.error),a()};e.addEventListener("success",r),e.addEventListener("error",i)}));return n.then((n=>{n instanceof IDBCursor&&i.set(n,e)})).catch((()=>{})),u.set(n,e),n}(e);if(s.has(e))return s.get(e);const n=p(e);return n!==e&&(s.set(e,n),u.set(n,e)),n}const f=e=>u.get(e);function v(e,n,{blocked:t,upgrade:a,blocking:r,terminated:i}={}){const o=indexedDB.open(e,n),l=g(o);return a&&o.addEventListener("upgradeneeded",(e=>{a(g(o.result),e.oldVersion,e.newVersion,g(o.transaction))})),t&&o.addEventListener("blocked",(()=>t())),l.then((e=>{i&&e.addEventListener("close",(()=>i())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),l}const m=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function h(e,n){if(!(e instanceof IDBDatabase)||n in e||"string"!==typeof n)return;if(b.get(n))return b.get(n);const t=n.replace(/FromIndex$/,""),a=n!==t,r=y.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!r&&!m.includes(t))return;const i=async function(e,...n){const i=this.transaction(e,r?"readwrite":"readonly");let o=i.store;return a&&(o=o.index(n.shift())),(await Promise.all([o[t](...n),r&&i.done]))[0]};return b.set(n,i),i}c=(e=>({...e,get:(n,t,a)=>h(n,t)||e.get(n,t,a),has:(n,t)=>!!h(n,t)||e.has(n,t)}))(c)},67495:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.useAccordionParent=n.AccordionParentProvider=n.AccordionParentContext=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=r(n);if(t&&t.has(e))return t.get(e);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=i?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(a,o,l):a[o]=e[o]}a.default=e,t&&t.set(e,a);return a}(t(2784));function r(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(r=function(e){return e?t:n})(e)}const i=(0,a.createContext)({activeKey:void 0,onItemPress:()=>{}});n.AccordionParentContext=i;n.useAccordionParent=()=>(0,a.useContext)(i);n.AccordionParentProvider=({children:e,defaultActiveKey:n,onItemPress:t})=>{const r=(0,a.useState)(n),o=r[0],l=r[1],s=(0,a.useCallback)((e=>{null===t||void 0===t||t(e),l(e===o?void 0:e)}),[t,o]),u=(0,a.useMemo)((()=>({activeKey:o,onItemPress:s})),[o,s]);return a.default.createElement(i.Provider,{value:u},e)}},88694:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.accordionVisibleMaxHeight=n.accordionIconVisibleRotate=n.accordionIconHiddenRotate=void 0;n.accordionVisibleMaxHeight={dense:200,normal:400};n.accordionIconHiddenRotate=-180;n.accordionIconVisibleRotate=0},98607:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.outDuration=n.inDuration=n.easing=n.collapsibleVisibleOpacity=n.collapsibleVisibleMaxSize=n.collapsibleHiddenOpacity=n.collapsibleHiddenMaxSize=n.animateOutOpacityConfig=n.animateOutMaxSizeConfig=n.animateInOpacityConfig=n.animateInMaxSizeConfig=void 0;var a=t(62426);n.collapsibleHiddenOpacity=0;n.collapsibleVisibleOpacity=1;n.collapsibleHiddenMaxSize=0;const r=1e3;n.collapsibleVisibleMaxSize=r;const i="global";n.easing=i;const o="slow1";n.inDuration=o;const l="moderate3";n.outDuration=l;const s={vertical:{property:"opacity",easing:i,duration:o,toValue:1,fromValue:0,useNativeDriver:!1},horizontal:{property:"opacity",easing:"exitFunctional",duration:"fast1",delay:a.durations.fast1,toValue:1,fromValue:0,useNativeDriver:!1}};n.animateInOpacityConfig=s;const u={vertical:Object.assign({},s.vertical,{duration:l,toValue:0,fromValue:1}),horizontal:Object.assign({},s.horizontal,{toValue:0,fromValue:1,delay:void 0})};n.animateOutOpacityConfig=u;const c={vertical:{property:"height",easing:i,duration:o,toValue:r,fromValue:0,useNativeDriver:!1},horizontal:{property:"width",easing:"global",duration:"fast1",useNativeDriver:!1,toValue:r,fromValue:0}};n.animateInMaxSizeConfig=c;const d={vertical:Object.assign({},c.vertical,{duration:l,toValue:0,fromValue:r}),horizontal:Object.assign({},c.horizontal,{delay:a.durations.fast1,toValue:0,fromValue:r})};n.animateOutMaxSizeConfig=d},34966:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.tooltipVisibleY=n.tooltipVisibleOpacity=n.tooltipHiddenY=n.tooltipHiddenOpacity=n.getTranslateConfigByPlacement=n.animateOutOpacityConfig=n.animateInOpacityConfig=void 0;n.tooltipHiddenOpacity=0;n.tooltipVisibleOpacity=1;n.tooltipHiddenY=16;n.tooltipVisibleY=0;const t={duration:"fast1",delay:25},a=Object.assign({property:"opacity"},t,{easing:"enterFunctional",toValue:1,fromValue:0});n.animateInOpacityConfig=a;const r=Object.assign({property:"opacity"},t,{easing:"exitFunctional",toValue:0,fromValue:1});n.animateOutOpacityConfig=r;n.getTranslateConfigByPlacement=({placement:e,isExiting:n=!1})=>{let a;switch(e){case"top":default:a={property:"translateY",fromValue:16,toValue:0};break;case"bottom":a={property:"translateY",fromValue:-16,toValue:0};break;case"left":a={property:"translateX",fromValue:16,toValue:0};break;case"right":a={property:"translateX",fromValue:-16,toValue:0}}if(n){const e=a.fromValue;a.fromValue=a.toValue,a.toValue=e}return Object.assign({},t,a,{easing:n?"exitFunctional":"enterFunctional"})}},9527:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.useAccordionDividerColor=void 0;var a=t(16527);n.useAccordionDividerColor=()=>(0,a.useSpectrumConditional)({light:"line",dark:"lineHeavy"})},12641:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.useAccordionSpacing=void 0;var a=t(33524),r=t(91251);n.useAccordionSpacing=()=>(0,a.useScaleConditional)(r.accordionSpacing)},86394:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.animateRotateConfig=void 0;var a=t(98607);const r={property:"rotate",easing:a.easing,duration:a.inDuration};n.animateRotateConfig=r},91251:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.accordionSpacing=n.accordionMinWidth=void 0;n.accordionSpacing={normal:{spacingTop:2,spacingHorizontal:3,spacingBottom:3},dense:{spacingTop:2,spacingHorizontal:4,spacingBottom:4}};n.accordionMinWidth=300},44514:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.spacingVertical=n.spacingHorizontal=n.maxWidth=void 0;n.maxWidth=260;n.spacingHorizontal=2;n.spacingVertical=1},24728:function(e,n,t){n.U=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=s(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(92259),i=t(67495),o=t(9527),l=t(48972);function s(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(s=function(e){return e?t:n})(e)}n.U=({children:e,defaultActiveKey:n,onItemPress:t,testID:s})=>{const u=(0,o.useAccordionDividerColor)();return a.default.createElement(i.AccordionParentProvider,{defaultActiveKey:n,onItemPress:t},a.default.createElement(l.VStack,{testID:s,width:"100%"},(0,r.join)(a.Children.toArray(e),a.default.createElement(l.Divider,{color:u}))))}},77077:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.AccordionTitle=n.AccordionMedia=n.AccordionIcon=n.AccordionHeader=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=m(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(67495),i=t(88694),o=t(89036),l=t(33524),s=t(14974),u=t(65605),c=t(48972),d=t(99423),p=t(95791),g=t(61641),f=t(83754),v=t(24499);function m(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(m=function(e){return e?t:n})(e)}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},y.apply(this,arguments)}const b=(0,a.memo)((({media:e})=>a.default.createElement(c.Box,{flexGrow:0,flexShrink:0},e)));n.AccordionMedia=b;const h=(0,a.memo)((({title:e,subtitle:n})=>a.default.createElement(c.Box,{flexGrow:1,flexShrink:1,justifyContent:"flex-start",dangerouslySetClassName:u.truncateClassName},a.default.createElement(c.VStack,null,a.default.createElement(g.TextHeadline,{as:"div",overflow:"wrap"},e),!!n&&a.default.createElement(g.TextBody,{as:"div",overflow:"wrap",color:"foregroundMuted",dangerouslySetClassName:u.overflowClassName},n)))));n.AccordionTitle=h;const C=(0,a.memo)((({collapsed:e})=>a.default.createElement(c.Box,{justifyContent:"flex-end"},a.default.createElement(d.AnimatedCaret,{rotate:e?i.accordionIconHiddenRotate:i.accordionIconVisibleRotate}))));n.AccordionIcon=C;const k=(0,a.memo)((0,a.forwardRef)((({itemKey:e,title:n,subtitle:t,onPress:i,media:u,collapsed:d=!1,testID:g},m)=>{const k=(0,r.useAccordionParent)().onItemPress,x=(0,o.useCellSpacing)(),S=(0,l.useScaleConditional)(s.listHeight),j=(0,a.useCallback)((()=>{null===i||void 0===i||i(e),null===k||void 0===k||k(e)}),[i,k,e]);return a.default.createElement("h2",{className:f.typographyResets},a.default.createElement(p.Pressable,{noScaleOnPress:!0,transparentWhileInactive:!0,backgroundColor:"background",onPress:j,width:"100%",testID:g,ref:m,"aria-expanded":!d,"aria-controls":(0,v.getAccordionPanelId)(e),id:(0,v.getAccordionHeaderId)(e)},a.default.createElement(c.HStack,y({width:"100%",alignItems:"center",gap:2,minHeight:S},x.outer),!!u&&a.default.createElement(b,{media:u}),a.default.createElement(h,{title:n,subtitle:t}),a.default.createElement(C,{collapsed:d}))))})));n.AccordionHeader=k},66332:function(e,n,t){n.Q=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=u(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(67495),i=t(91251),o=t(48972),l=t(77077),s=t(58796);function u(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(u=function(e){return e?t:n})(e)}const c=(0,a.memo)((({itemKey:e,title:n,subtitle:t,children:u,onPress:c,media:d,testID:p,headerRef:g,panelRef:f,maxHeight:v})=>{const m=(0,r.useAccordionParent)().activeKey!==e;return a.default.createElement(o.VStack,{minWidth:i.accordionMinWidth,testID:p},a.default.createElement(l.AccordionHeader,{itemKey:e,media:d,title:n,subtitle:t,onPress:c,collapsed:m,testID:p&&`${p}-header`,ref:g}),a.default.createElement(s.AccordionPanel,{collapsed:m,itemKey:e,testID:p&&`${p}-panel`,ref:f,maxHeight:v},u))}));n.Q=c},58796:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.AccordionPanel=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=u(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(88694),i=t(12641),o=t(33524),l=t(46744),s=t(24499);function u(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(u=function(e){return e?t:n})(e)}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},c.apply(this,arguments)}const d=(0,a.memo)((0,a.forwardRef)((({children:e,collapsed:n=!0,itemKey:t,testID:u,maxHeight:d},p)=>{const g=(0,o.useScaleConditional)(r.accordionVisibleMaxHeight),f=(0,i.useAccordionSpacing)();return a.default.createElement(l.Collapsible,c({collapsed:n,testID:u,maxHeight:null!==d&&void 0!==d?d:g,ref:p},f,{role:"region",accessibilityLabelledBy:(0,s.getAccordionHeaderId)(t),id:(0,s.getAccordionPanelId)(t)}),e)})));n.AccordionPanel=d},24499:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getAccordionPanelId=n.getAccordionHeaderId=void 0;n.getAccordionHeaderId=e=>`accordion-item-${e}-header`;n.getAccordionPanelId=e=>`accordion-item-${e}-panel`},58413:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.CellDetail=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=i(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var l=r?Object.getOwnPropertyDescriptor(e,o):null;l&&(l.get||l.set)?Object.defineProperty(a,o,l):a[o]=e[o]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(23849);function i(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(i=function(e){return e?t:n})(e)}const o=(0,a.memo)((function({detail:e,subdetail:n,variant:t="foregroundMuted"}){return a.default.createElement(a.default.Fragment,null,!!e&&a.default.createElement(r.TextBody,{as:"div",align:"end",overflow:"truncate"},e),!!n&&a.default.createElement(r.TextBody,{as:"div",align:"end",overflow:"truncate",color:t},n))}));n.CellDetail=o},40380:function(e,n,t){n.u=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=f(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(33524),i=t(14974),o=t(59508),l=t(29904),s=t(23849),u=t(43013),c=t(65605),d=t(70043),p=t(58413);const g=["accessory","action","compact","title","description","detail","disabled","media","multiline","selected","subdetail","variant"];function f(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(f=function(e){return e?t:n})(e)}function v(){return v=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},v.apply(this,arguments)}const m=(0,a.memo)((0,a.forwardRef)((function(e,n){let t=e.accessory,f=e.action,m=e.compact,y=e.title,b=e.description,h=e.detail,C=e.disabled,k=e.media,x=e.multiline,S=e.selected,j=e.subdetail,E=e.variant,T=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,g);const O=(0,r.useScaleConditional)(m?i.compactListHeight:i.listHeight),w=S?"selected":t;let _;return f?_=a.default.createElement(o.Box,{justifyContent:"flex-end"},f):(h||j)&&(_=a.default.createElement(p.CellDetail,{detail:h,subdetail:j,variant:E})),a.default.createElement(c.Cell,v({},T,{accessory:w&&a.default.createElement(d.CellAccessory,{type:w}),detail:_,media:k,disabled:C,minHeight:O,selected:S,ref:n}),a.default.createElement(l.VStack,null,!!y&&a.default.createElement(u.TextHeadline,{as:"div",overflow:"truncate"},y),!!b&&a.default.createElement(s.TextBody,{as:"div",color:"foregroundMuted",overflow:x?void 0:"truncate",dangerouslySetClassName:x?c.overflowClassName:void 0},b)))})));n.u=m},63006:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.CollapseArrow=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=l(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(31744),i=t(86421),o=t(2408);function l(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(l=function(e){return e?t:n})(e)}const s=(0,a.memo)((function({degrees:e=180,collapsed:n}){const t=(0,r.useRotateAnimation)(e),l=t.rotateAnimationRef,s=t.animateClockwise,u=t.animateCounterClockwise;return(0,a.useEffect)((()=>{n?u():s()}),[s,u,n]),a.default.createElement(i.Icon,{ref:l,name:(0,o.isRtl)()?"caretLeft":"caretRight",size:"s",color:"foregroundMuted"})}));n.CollapseArrow=s},89951:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.Collapsible=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=s(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(53316),i=t(84681),o=t(48972),l=t(39635);function s(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(s=function(e){return e?t:n})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},u.apply(this,arguments)}const c=(0,a.memo)((0,a.forwardRef)((({children:e,collapsed:n=!0,maxHeight:t,maxWidth:s,accessibilityLabelledBy:c,direction:d="vertical",testID:p,id:g,role:f="region",dangerouslyDisableOverflowHidden:v=!1,spacing:m,spacingBottom:y,spacingEnd:b,spacingHorizontal:h,spacingStart:C,spacingTop:k,spacingVertical:x},S)=>{const j=(0,l.useCollapsibleMotionProps)({collapsed:n,direction:d,dangerouslyDisableOverflowHidden:v}),E=(0,i.useSpacingStyles)({spacingTop:k}),T=(0,i.useSpacingStyles)({spacing:m,spacingBottom:y,spacingEnd:b,spacingHorizontal:h,spacingStart:C,spacingVertical:x}),O=(0,a.useMemo)((()=>"horizontal"===d?{maxWidth:s,display:"inline-flex"}:{maxHeight:t}),[d,s,t]),w="horizontal"===d?o.HStack:o.Box;return a.default.createElement(r.m.div,u({},j,{"data-testid":p,ref:S,id:g,"aria-labelledby":c,role:f}),a.default.createElement("div",{className:E},a.default.createElement(w,u({overflow:s||t?"auto":void 0},O,{dangerouslySetClassName:T}),e)))})));n.Collapsible=c},46744:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var a=t(63006);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))}));var r=t(89951);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}))},39635:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.useCollapsibleMotionProps=void 0;var a=t(2784),r=t(98607),i=t(48104);n.useCollapsibleMotionProps=({collapsed:e,direction:n="vertical",dangerouslyDisableOverflowHidden:t})=>{const o=(0,a.useMemo)((()=>{const e={visibility:"visible"};return t?e:Object.assign({},e,{overflow:"hidden"})}),[t]);return(0,i.useMotionProps)({enterConfigs:[r.animateInOpacityConfig[n],Object.assign({},r.animateInMaxSizeConfig[n],{toValue:"auto"})],exitConfigs:{tokens:[r.animateOutOpacityConfig[n],r.animateOutMaxSizeConfig[n]],transitionEnd:{visibility:"hidden"}},style:o,initial:!1,animate:e?"exit":"enter"})}},65060:function(e,n,t){n.$=void 0;var a=u(t(2784)),r=t(53316),i=t(56582),o=t(48104),l=u(t(2506));function s(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(s=function(e){return e?t:n})(e)}function u(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=s(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}return a.default=e,t&&t.set(e,a),a}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},c.apply(this,arguments)}const d=(0,a.memo)((function({size:e,color:n="foregroundMuted",testID:t}){const s=(0,i.usePalette)(),u=(0,o.useMotionProps)({animate:{rotate:[0,360]},transition:{repeat:1/0,easing:"linear",duration:"slow4"}}),d=(0,a.useMemo)((()=>({fontSize:`${e}px`,borderTopColor:s.backgroundAlternate,borderRightColor:s.backgroundAlternate,borderBottomColor:s[n],borderLeftColor:s.backgroundAlternate})),[s,e,n]);return a.default.createElement(r.m.div,c({"data-testid":t,role:"status","aria-busy":!0,"aria-live":"polite",style:d,className:l.spinner.base},u))}));n.$=d,d.displayName="Spinner"},99423:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.AnimatedCaret=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=c(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(53316),i=t(86394),o=t(6058),l=t(48972),s=t(48104);const u=["rotate","size","color","testID"];function c(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(c=function(e){return e?t:n})(e)}function d(){return d=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},d.apply(this,arguments)}const p=(0,a.memo)((function(e){let n=e.rotate,t=e.size,c=void 0===t?"s":t,p=e.color,g=void 0===p?"foregroundMuted":p,f=e.testID,v=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,u);const m=(0,s.useMotionProps)({enterConfigs:[Object.assign({},i.animateRotateConfig,{toValue:n})],initial:!1});return a.default.createElement(l.HStack,null,a.default.createElement(r.MotionConfig,{reducedMotion:"user"},a.default.createElement(r.m.div,d({},m,{"data-testid":`${f}-motion`}),a.default.createElement(o.Icon,d({name:"caretUp",size:c,color:g},v)))))}));n.AnimatedCaret=p},68130:function(e,n,t){n.m=void 0;var a,r=(a=t(2784))&&a.__esModule?a:{default:a},i=t(59307),o=t(60723),l=t(48972),s=t(7610);n.m=({primaryAction:e,secondaryAction:n,testID:t})=>{const a=(0,i.useModalParent)().hideDividers;return e.type!==o.Button||n&&e.type!==o.Button?(console.error("Modal footer actions need to be CDS Button component"),null):r.default.createElement(l.HStack,{spacingHorizontal:3,spacingVertical:2,justifyContent:"flex-end",width:"100%",gap:2,dangerouslySetClassName:s.modalFooterClassName,testID:t,borderedTop:!a},n,e)}},76470:function(e,n,t){n.u=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=l(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(44445),i=t(4267),o=t(958);function l(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(l=function(e){return e?t:n})(e)}const s=e=>{e.preventDefault(),e.stopPropagation()};n.u=({children:e,content:n,placement:t="top",gap:l=1,disablePortal:u,testID:c,zIndex:d,tooltipId:p})=>{const g=(0,o.useTooltipState)(p),f=g.isOpen,v=g.handleOnMouseEnter,m=g.handleOnMouseLeave,y=g.handleOnFocus,b=g.handleOnBlur,h=g.tooltipId,C=(0,a.useMemo)((()=>(0,a.cloneElement)(e,{"aria-describedby":h})),[e,h]),k=(0,a.useMemo)((()=>({placement:t})),[t]);return a.default.createElement(r.Popover,{contentPosition:k,disablePortal:u,onMouseEnter:v,onMouseLeave:m,onFocus:y,onBlur:b,onMouseDown:s,invertPopoverSpectrum:!0,visible:f,content:a.default.createElement(i.TooltipContent,{tooltipId:h,content:n,gap:l,testID:c,zIndex:d,placement:t})},C)}},4267:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.TooltipContent=void 0;var a=function(e,n){if(!n&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=p(n);if(t&&t.has(e))return t.get(e);var a={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(a,i,o):a[i]=e[i]}a.default=e,t&&t.set(e,a);return a}(t(2784)),r=t(53316),i=t(34966),o=t(44514),l=t(72875),s=t(59508),u=t(48104),c=t(76776),d=t(61641);function p(e){if("function"!==typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(p=function(e){return e?t:n})(e)}function g(){return g=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},g.apply(this,arguments)}const f=(0,a.memo)((0,a.forwardRef)((({content:e,gap:n,testID:t,zIndex:p,tooltipId:f,placement:v="top"},m)=>{const y=(0,a.useMemo)((()=>({padding:c.spacing[n],zIndex:null!==p&&void 0!==p?p:l.zIndex.overlays.tooltip})),[n,p]),b=(0,u.useMotionProps)({style:y,enterConfigs:[i.animateInOpacityConfig,(0,i.getTranslateConfigByPlacement)({placement:v})],exitConfigs:[i.animateOutOpacityConfig,(0,i.getTranslateConfigByPlacement)({placement:v,isExiting:!0})],exit:"exit"});return a.default.createElement(r.m.div,g({},b,{"data-testid":`${t}-motion`}),a.default.createElement(s.Box,{ref:m,spacingHorizontal:o.spacingHorizontal,spacingVertical:o.spacingVertical,background:"background",borderRadius:"tooltipV2",maxWidth:o.maxWidth,testID:t},"string"===typeof e?a.default.createElement(d.TextLabel2,{as:"p",overflow:"break",id:f,accessibilityLabel:e},e):a.default.createElement("div",{id:f},e)))})));n.TooltipContent=f},958:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.useTooltipState=void 0;var a=t(2784),r=t(92259),i=t(64119);n.useTooltipState=e=>{const n=(0,r.useToggler)(!1),t=n[0],o=n[1],l=o.toggleOn,s=o.toggleOff,u=(0,r.useToggler)(!1),c=u[0],d=u[1],p=d.toggleOn,g=d.toggleOff,f=(0,a.useMemo)((()=>null!==e&&void 0!==e?e:(0,i.generateRandomId)("tooltip--")),[e]),v=(0,a.useCallback)((()=>{g()}),[g]),m=(0,a.useCallback)((()=>{s()}),[s]);return(0,a.useMemo)((()=>({isOpen:t||c,tooltipId:f,handleOnMouseEnter:l,handleOnMouseLeave:m,handleOnFocus:p,handleOnBlur:v})),[v,p,l,m,c,t,f])}},88410:function(e,n,t){t.d(n,{Pe:function(){return y},SV:function(){return C},S1:function(){return S},NO:function(){return k}});var a=t(34089),r=t.n(a),i=t(2784),o=t(52322);const l=["apiKey"],s=["type"];function u(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,i,o,l=[],s=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(a=i.call(t)).done)&&(l.push(a.value),l.length!==n);s=!0);}catch(c){u=!0,r=c}finally{try{if(!s&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return l}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function d(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){f(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function f(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class v{constructor(e,n){if(this.internalClient=void 0,this.options=void 0,this.globalMetadata=void 0,this.sessionUUID=void 0,this.userId=void 0,this.onUnhandledError=e=>{if(!["unhandledPromiseRejection","unhandledException"].includes(e?._handledState?.severityReason?.type??""))return!0;let n=e?.originalError;return n&&n instanceof Error||(n=new Error("unhandled error - additionally no Error object caught")),this.logError(n,g({isHandled:!1,context:e.context??"UNHANDLED_ERROR",severity:"crash"},this.getUserContext())),!1},this.internalClient=e,this.options=n,this.globalMetadata={},this.internalClient.addOnError(this.onUnhandledError),this.options.getUserContext){this.internalClient.addOnSession((e=>{if(!this.options.getUserContext)return!1;const n=this.options.getUserContext().userId;return e.setUser(n),!0})),this.internalClient.startSession();const e=this.options.getUserContext(),n=e.userId,t=e.sessionUUID;this.sessionUUID=t,this.userId=n}}logError(e,n){const t=this.options.beforeSend?.(e,n);if(!1===t)return;const a=n.apiKey,r=d(n,l);if(this.options.getUserContext){const e=this.options.getUserContext(),n=e.userId,t=e.sessionUUID,a=n!==this.userId;a&&(this.userId=n);const r=t!==this.sessionUUID;r&&(this.sessionUUID=t),(a||r)&&this.internalClient.startSession()}this.internalClient.notify(e,(e=>{e.apiKey=a??this.options.apiKey,n.fingerprint&&(e.groupingHash=n.fingerprint),n.isHandled||(e.unhandled=!0),e.context=n.context,e.severity=function(e){switch(e){case"debug":return"info";case"warning":return"warning";default:return"error"}}(n.severity),e.addMetadata("Metadata",g(g(g(g({},this.globalMetadata),this.getUserContext()),r),{},{errorVitalsVersion:"0"}))}))}addBreadcrumb(e,n){const t=n??{},a=t.type,r=d(t,s),i=this.options.beforeBreadcrumb?.(e,n??{});!1!==i&&this.internalClient.leaveBreadcrumb(e,r,a)}setGlobalMetadata(e){for(const t of Object.entries(e)){var n=u(t,2);const e=n[0],a=n[1];void 0===a?delete this.globalMetadata[e]:this.globalMetadata[e]=a}}getUserContext(){if(this.options.getUserContext){const e=this.options.getUserContext();return{pageKey:e.page_key,pagePath:e.page_path,ujs:e.ujs}}return{}}}const m=(0,i.createContext)({client:null}),y=m.Provider,b=(0,i.createContext)({name:"ROOT"}),h=class extends i.Component{constructor(...e){super(...e),this.state={error:void 0},this.clearError=()=>{this.setState({error:void 0}),this.props?.onReset?.()}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){const t=this.props,a=t.onCatch,r=t.defaultMetadata,i=t.getErrorMetadata,o=t.errorVitalsClientContextValue,l=t.errorContextValue;a?.(e,n),o.client&&o.client.logError(e,g(g(g({},r??{}),i?.(e,n)??{}),l))}render(){const e=this.props,n=e.children,t=e.fallback,a=e.errorContextValue,r=this.state.error;return r?t?(0,o.jsx)(b.Provider,{value:a,children:(0,i.cloneElement)(t,{error:r,resetErrorBoundary:this.clearError})}):null:(0,o.jsx)(b.Provider,{value:a,children:n})}};function C(e){const n=(0,i.useContext)(m);if(!n.client)throw new Error("ErrorBoundary must be within a ClientProvider.");const t=(0,i.useContext)(b),a=(0,i.useMemo)((()=>{const n=t?.path;return g(g({},t),{},{name:e.name,path:n?`${n} / ${e.name}`:e.name})}),[t,e.name]);return(0,o.jsx)(h,g(g({},e),{},{errorContextValue:a,errorVitalsClientContextValue:n}))}function k(){const e=(0,i.useContext)(m).client;if(!e)throw new Error("useErrorVitals() must be called within a ClientProvider.");const n=(0,i.useContext)(b);return(0,i.useMemo)((()=>({logError(t,a){e.logError(t,g({name:n.name,path:n.path},a))},addBreadcrumb:e.addBreadcrumb,setGlobalMetadata:e.setGlobalMetadata})),[e,n.name,n.path])}const x={};function S(e){if(x[e.apiKey])return console.warn("[error-vitals-web]","multiple calls to `init()` with the same apiKey will have no effect!"),x[e.apiKey];const n=r().createClient({apiKey:e.apiKey,appVersion:e.appVersion,releaseStage:e.environment,appType:e.appName,autoDetectErrors:e.useGlobalHandlers,autoTrackSessions:!1,collectUserIp:!1,context:"NOT_SET",enabledErrorTypes:{unhandledExceptions:!0,unhandledRejections:!0},endpoints:{notify:"https://exceptions.coinbase.com",sessions:"https://sessions.coinbase.com"},maxBreadcrumbs:e.maxBreadcrumbs,maxEvents:e.maxEvents}),t=new v(n,e);return x[e.apiKey]=t,t}}}]);
//# sourceMappingURL=310.52448d559afa9cfc.js.map